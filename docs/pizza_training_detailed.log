2025-04-01 09:59:16,680 - INFO - ================================================================================
2025-04-01 09:59:16,680 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 09:59:16,680 - INFO - ================================================================================
2025-04-01 09:59:16,680 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 09:59:16,680 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 09:59:16,680 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 09:59:16,680 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 09:59:16,680 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 09:59:16,680 - INFO - ================================================================================
2025-04-01 09:59:16,681 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 09:59:16,731 - ERROR - Fehler im Optimierungsprozess: division by zero
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1617, in main
    preprocessing_params = analyzer.analyze(sample_size=50)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 187, in analyze
    self.stats['class_weights'] = {cls: max_count/count for cls, count in self.stats['class_counts'].items()}
                                        ~~~~~~~~~^~~~~~
ZeroDivisionError: division by zero
2025-04-01 10:04:27,423 - INFO - ================================================================================
2025-04-01 10:04:27,423 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:04:27,423 - INFO - ================================================================================
2025-04-01 10:04:27,423 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:04:27,424 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:04:27,424 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:04:27,424 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:04:27,424 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:04:27,424 - INFO - ================================================================================
2025-04-01 10:04:27,424 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:04:27,463 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:04:27,463 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:04:27,464 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:04:27,464 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:04:27,464 - INFO - RGB-Mittelwerte: [0.4785, 0.3970, 0.3256]
2025-04-01 10:04:27,464 - INFO - RGB-Standardabweichungen: [0.2362, 0.2527, 0.2669]
2025-04-01 10:04:27,464 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:04:27,464 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1621, in main
    train_loader, val_loader, class_names, preprocessing_params = create_optimized_dataloaders(config, preprocessing_params)
                                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 419, in create_optimized_dataloaders
    mean = preprocessing_params['mean']
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-01 10:07:29,095 - INFO - ================================================================================
2025-04-01 10:07:29,095 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:07:29,095 - INFO - ================================================================================
2025-04-01 10:07:29,096 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:07:29,096 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:07:29,096 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:07:29,096 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:07:29,096 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:07:29,096 - INFO - ================================================================================
2025-04-01 10:07:29,096 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:07:29,135 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:07:29,135 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:07:29,135 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:07:29,135 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:07:29,135 - INFO - RGB-Mittelwerte: [0.4918, 0.4074, 0.3386]
2025-04-01 10:07:29,135 - INFO - RGB-Standardabweichungen: [0.2394, 0.2569, 0.2691]
2025-04-01 10:07:29,135 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:07:29,135 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.49177907 0.4074075  0.33863213], std=[0.23935119 0.25691293 0.26911776]
2025-04-01 10:07:29,136 - INFO - Klassenverteilung (train):
2025-04-01 10:07:29,136 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-01 10:07:29,136 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-01 10:07:29,136 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-01 10:07:29,136 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-01 10:07:29,137 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-01 10:07:29,137 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-01 10:07:29,226 - INFO - Modell erstellt mit 582 Parametern
2025-04-01 10:07:29,641 - INFO - Speicheranalyse:
2025-04-01 10:07:29,641 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:07:29,641 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:07:29,641 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:07:29,641 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:07:29,641 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:07:29,641 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-01 10:07:29,642 - INFO - Speicheranalyse:
2025-04-01 10:07:29,642 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:07:29,642 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:07:29,642 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:07:29,642 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:07:29,642 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:07:29,710 - INFO - Klassengewichte für Loss-Funktion: [1.61, 0.8, 1.12, 0.8]
2025-04-01 10:07:29,820 - ERROR - Fehler im Optimierungsprozess: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1632, in main
    history, trained_model = train_microcontroller_model(model, train_loader, val_loader, config, class_names)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 713, in train_microcontroller_model
    loss = criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
2025-04-01 10:10:38,398 - INFO - ================================================================================
2025-04-01 10:10:38,398 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:10:38,398 - INFO - ================================================================================
2025-04-01 10:10:38,398 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:10:38,398 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:10:38,398 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:10:38,398 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:10:38,398 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:10:38,398 - INFO - ================================================================================
2025-04-01 10:10:38,398 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:10:38,433 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:10:38,433 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:10:38,433 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:10:38,433 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:10:38,433 - INFO - RGB-Mittelwerte: [0.4717, 0.3895, 0.3267]
2025-04-01 10:10:38,433 - INFO - RGB-Standardabweichungen: [0.2326, 0.2479, 0.2610]
2025-04-01 10:10:38,433 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:10:38,433 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47171046 0.38951624 0.32670155], std=[0.23256324 0.24793205 0.26100104]
2025-04-01 10:10:38,434 - INFO - Klassenverteilung (train):
2025-04-01 10:10:38,434 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-01 10:10:38,434 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-01 10:10:38,434 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-01 10:10:38,434 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-01 10:10:38,434 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-01 10:10:38,434 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-01 10:10:38,500 - INFO - Modell erstellt mit 582 Parametern
2025-04-01 10:10:38,616 - INFO - Speicheranalyse:
2025-04-01 10:10:38,616 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:10:38,616 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:10:38,616 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:10:38,616 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:10:38,616 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:10:38,616 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-01 10:10:38,617 - INFO - Speicheranalyse:
2025-04-01 10:10:38,617 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:10:38,617 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:10:38,617 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:10:38,617 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:10:38,617 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:10:38,668 - INFO - Klassengewichte für Loss-Funktion: [1.88, 0.7, 0.75, 1.41]
2025-04-01 10:10:38,730 - ERROR - Fehler im Optimierungsprozess: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1632, in main
    history, trained_model = train_microcontroller_model(model, train_loader, val_loader, config, class_names)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 713, in train_microcontroller_model
    loss = criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
2025-04-01 10:20:30,306 - INFO - ================================================================================
2025-04-01 10:20:30,306 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:20:30,306 - INFO - ================================================================================
2025-04-01 10:20:30,306 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:20:30,306 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:20:30,306 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:20:30,306 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:20:30,306 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:20:30,306 - INFO - ================================================================================
2025-04-01 10:20:30,306 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:20:30,340 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:20:30,341 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:20:30,341 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:20:30,341 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:20:30,341 - INFO - RGB-Mittelwerte: [0.4686, 0.3903, 0.3238]
2025-04-01 10:20:30,341 - INFO - RGB-Standardabweichungen: [0.2261, 0.2443, 0.2605]
2025-04-01 10:20:30,341 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:20:30,341 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.46857427 0.39032511 0.32379357], std=[0.22613848 0.24427633 0.26053721]
2025-04-01 10:20:30,341 - INFO - Klassenverteilung (train):
2025-04-01 10:20:30,341 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-01 10:20:30,341 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-01 10:20:30,341 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-01 10:20:30,342 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-01 10:20:30,342 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-01 10:20:30,342 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-01 10:20:30,408 - INFO - Modell erstellt mit 582 Parametern
2025-04-01 10:20:30,522 - INFO - Speicheranalyse:
2025-04-01 10:20:30,522 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:20:30,522 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:20:30,522 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:20:30,522 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:20:30,522 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:20:30,522 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-01 10:20:30,523 - INFO - Speicheranalyse:
2025-04-01 10:20:30,523 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:20:30,523 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:20:30,523 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:20:30,523 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:20:30,523 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:20:30,586 - INFO - Klassengewichte für Loss-Funktion: [1.41, 1.02, 1.25, 0.66]
2025-04-01 10:20:30,660 - ERROR - Fehler im Optimierungsprozess: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1634, in main
    history, trained_model = train_microcontroller_model(model, train_loader, val_loader, config, class_names)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 715, in train_microcontroller_model
    loss = criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
2025-04-01 10:23:49,917 - INFO - ================================================================================
2025-04-01 10:23:49,917 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:23:49,917 - INFO - ================================================================================
2025-04-01 10:23:49,917 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:23:49,917 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:23:49,917 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:23:49,917 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:23:49,917 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:23:49,917 - INFO - ================================================================================
2025-04-01 10:23:49,917 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:23:49,949 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:23:49,949 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:23:49,949 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:23:49,949 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:23:49,949 - INFO - RGB-Mittelwerte: [0.4818, 0.4023, 0.3301]
2025-04-01 10:23:49,949 - INFO - RGB-Standardabweichungen: [0.2316, 0.2526, 0.2641]
2025-04-01 10:23:49,950 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:23:49,950 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.48180477 0.40228602 0.33009192], std=[0.23155595 0.25260314 0.26407573]
2025-04-01 10:23:49,950 - INFO - Klassenverteilung (train):
2025-04-01 10:23:49,950 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-01 10:23:49,950 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-01 10:23:49,950 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-01 10:23:49,950 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-01 10:23:49,951 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-01 10:23:49,951 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-01 10:23:50,018 - INFO - Modell erstellt mit 582 Parametern
2025-04-01 10:23:50,132 - INFO - Speicheranalyse:
2025-04-01 10:23:50,132 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:23:50,132 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:23:50,132 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:23:50,132 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:23:50,132 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:23:50,132 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-01 10:23:50,133 - INFO - Speicheranalyse:
2025-04-01 10:23:50,133 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:23:50,133 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:23:50,133 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:23:50,133 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:23:50,133 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:23:50,190 - INFO - Klassengewichte für Loss-Funktion: [0.87, 0.87, 1.12, 1.25]
2025-04-01 10:23:50,262 - ERROR - Fehler im Optimierungsprozess: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1634, in main
    history, trained_model = train_microcontroller_model(model, train_loader, val_loader, config, class_names)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 715, in train_microcontroller_model
    loss = criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 1295, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/functional.py", line 3494, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: weight tensor should be defined either for all 6 classes or no classes but got weight tensor of shape: [4]
2025-04-01 10:26:34,347 - INFO - ================================================================================
2025-04-01 10:26:34,347 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-01 10:26:34,347 - INFO - ================================================================================
2025-04-01 10:26:34,347 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-01 10:26:34,347 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-01 10:26:34,347 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-01 10:26:34,347 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-01 10:26:34,347 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-01 10:26:34,347 - INFO - ================================================================================
2025-04-01 10:26:34,347 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-01 10:26:34,381 - INFO - Datensatzanalyse abgeschlossen:
2025-04-01 10:26:34,381 - INFO - Gesamtzahl der Bilder: 57
2025-04-01 10:26:34,381 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-01 10:26:34,381 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-01 10:26:34,381 - INFO - RGB-Mittelwerte: [0.4887, 0.4040, 0.3337]
2025-04-01 10:26:34,381 - INFO - RGB-Standardabweichungen: [0.2407, 0.2564, 0.2676]
2025-04-01 10:26:34,381 - INFO - Bereite optimierte Datenlader vor...
2025-04-01 10:26:34,381 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.48874808 0.40395175 0.33373349], std=[0.24068864 0.25642604 0.2676274 ]
2025-04-01 10:26:34,382 - INFO - Klassenverteilung (train):
2025-04-01 10:26:34,382 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-01 10:26:34,382 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-01 10:26:34,382 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-01 10:26:34,382 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-01 10:26:34,382 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-01 10:26:34,382 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-01 10:26:34,459 - INFO - Modell erstellt mit 582 Parametern
2025-04-01 10:26:34,574 - INFO - Speicheranalyse:
2025-04-01 10:26:34,574 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:26:34,574 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:26:34,574 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:26:34,574 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:26:34,574 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:26:34,574 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-01 10:26:34,575 - INFO - Speicheranalyse:
2025-04-01 10:26:34,575 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-01 10:26:34,575 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-01 10:26:34,575 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-01 10:26:34,575 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-01 10:26:34,575 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-01 10:26:34,645 - INFO - Klassengewichte für Loss-Funktion: [1.07, 0.58, 0.75, 0.5, 1.0, 1.0]
2025-04-01 10:26:35,211 - INFO - Epoch 1/50 - Train Loss: 1.8029, Train Acc: 20.00% - Val Loss: 1.8018, Val Acc: 8.33%
2025-04-01 10:26:35,211 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,211 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,211 - INFO -   combined: 0.00% (0/3)
2025-04-01 10:26:35,211 - INFO -   mixed: 100.00% (1/1)
2025-04-01 10:26:35,213 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-01 10:26:35,357 - INFO - Epoch 2/50 - Train Loss: 1.8015, Train Acc: 15.56% - Val Loss: 1.8020, Val Acc: 8.33%
2025-04-01 10:26:35,357 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,357 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,357 - INFO -   combined: 0.00% (0/3)
2025-04-01 10:26:35,357 - INFO -   mixed: 100.00% (1/1)
2025-04-01 10:26:35,357 - INFO - EarlyStopping counter: 1/10
2025-04-01 10:26:35,511 - INFO - Epoch 3/50 - Train Loss: 1.8047, Train Acc: 11.11% - Val Loss: 1.8011, Val Acc: 8.33%
2025-04-01 10:26:35,511 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,511 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,511 - INFO -   combined: 0.00% (0/3)
2025-04-01 10:26:35,511 - INFO -   mixed: 100.00% (1/1)
2025-04-01 10:26:35,511 - INFO - EarlyStopping counter: 2/10
2025-04-01 10:26:35,660 - INFO - Epoch 4/50 - Train Loss: 1.7881, Train Acc: 31.11% - Val Loss: 1.7973, Val Acc: 25.00%
2025-04-01 10:26:35,660 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,660 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,660 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:35,660 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:35,662 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch4.pth
2025-04-01 10:26:35,801 - INFO - Epoch 5/50 - Train Loss: 1.7823, Train Acc: 28.89% - Val Loss: 1.7894, Val Acc: 25.00%
2025-04-01 10:26:35,801 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,801 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,801 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:35,801 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:35,802 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-01 10:26:35,951 - INFO - Epoch 6/50 - Train Loss: 1.7749, Train Acc: 24.44% - Val Loss: 1.7681, Val Acc: 25.00%
2025-04-01 10:26:35,951 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:35,951 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:35,951 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:35,951 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,098 - INFO - Epoch 7/50 - Train Loss: 1.7637, Train Acc: 26.67% - Val Loss: 1.7334, Val Acc: 25.00%
2025-04-01 10:26:36,098 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,098 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,099 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,099 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,235 - INFO - Epoch 8/50 - Train Loss: 1.7421, Train Acc: 31.11% - Val Loss: 1.6906, Val Acc: 25.00%
2025-04-01 10:26:36,235 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,235 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,235 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,235 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,382 - INFO - Epoch 9/50 - Train Loss: 1.7260, Train Acc: 28.89% - Val Loss: 1.6364, Val Acc: 25.00%
2025-04-01 10:26:36,382 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,382 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,382 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,382 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,533 - INFO - Epoch 10/50 - Train Loss: 1.7034, Train Acc: 26.67% - Val Loss: 1.5879, Val Acc: 25.00%
2025-04-01 10:26:36,533 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,533 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,533 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,533 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,534 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-01 10:26:36,679 - INFO - Epoch 11/50 - Train Loss: 1.6791, Train Acc: 26.67% - Val Loss: 1.5282, Val Acc: 25.00%
2025-04-01 10:26:36,679 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,679 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,679 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,679 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,833 - INFO - Epoch 12/50 - Train Loss: 1.6525, Train Acc: 15.56% - Val Loss: 1.4578, Val Acc: 25.00%
2025-04-01 10:26:36,834 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,834 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,834 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,834 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:36,973 - INFO - Epoch 13/50 - Train Loss: 1.6093, Train Acc: 26.67% - Val Loss: 1.4192, Val Acc: 25.00%
2025-04-01 10:26:36,973 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:36,973 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:36,973 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:36,973 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,125 - INFO - Epoch 14/50 - Train Loss: 1.5753, Train Acc: 28.89% - Val Loss: 1.4013, Val Acc: 25.00%
2025-04-01 10:26:37,125 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,125 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,125 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,125 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,291 - INFO - Epoch 15/50 - Train Loss: 1.6004, Train Acc: 17.78% - Val Loss: 1.3647, Val Acc: 25.00%
2025-04-01 10:26:37,291 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,291 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,291 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,291 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,293 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-01 10:26:37,444 - INFO - Epoch 16/50 - Train Loss: 1.5106, Train Acc: 26.67% - Val Loss: 1.3302, Val Acc: 25.00%
2025-04-01 10:26:37,444 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,444 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,444 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,444 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,588 - INFO - Epoch 17/50 - Train Loss: 1.5098, Train Acc: 20.00% - Val Loss: 1.3172, Val Acc: 25.00%
2025-04-01 10:26:37,588 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,588 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,588 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,588 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,747 - INFO - Epoch 18/50 - Train Loss: 1.5087, Train Acc: 26.67% - Val Loss: 1.3694, Val Acc: 25.00%
2025-04-01 10:26:37,748 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,748 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,748 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,748 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,748 - INFO - EarlyStopping counter: 1/10
2025-04-01 10:26:37,890 - INFO - Epoch 19/50 - Train Loss: 1.4739, Train Acc: 26.67% - Val Loss: 1.3565, Val Acc: 25.00%
2025-04-01 10:26:37,890 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:37,890 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:37,890 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:37,890 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:37,890 - INFO - EarlyStopping counter: 2/10
2025-04-01 10:26:38,029 - INFO - Epoch 20/50 - Train Loss: 1.4460, Train Acc: 33.33% - Val Loss: 1.3453, Val Acc: 25.00%
2025-04-01 10:26:38,029 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:38,029 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:38,029 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:38,029 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:38,029 - INFO - EarlyStopping counter: 3/10
2025-04-01 10:26:38,029 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-01 10:26:38,030 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-01 10:26:38,179 - INFO - Epoch 21/50 - Train Loss: 1.5099, Train Acc: 22.22% - Val Loss: 1.3604, Val Acc: 25.00%
2025-04-01 10:26:38,179 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:38,179 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:38,179 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:38,179 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:38,179 - INFO - EarlyStopping counter: 9/10
2025-04-01 10:26:38,329 - INFO - Epoch 22/50 - Train Loss: 1.4106, Train Acc: 33.33% - Val Loss: 1.3891, Val Acc: 25.00%
2025-04-01 10:26:38,330 - INFO - Klassenweise Genauigkeiten:
2025-04-01 10:26:38,330 - INFO -   basic: 0.00% (0/8)
2025-04-01 10:26:38,330 - INFO -   combined: 100.00% (3/3)
2025-04-01 10:26:38,330 - INFO -   mixed: 0.00% (0/1)
2025-04-01 10:26:38,330 - INFO - EarlyStopping counter: 10/10
2025-04-01 10:26:38,330 - INFO - Early Stopping in Epoche 22
2025-04-01 10:26:38,330 - INFO - Training abgeschlossen in 3.68 Sekunden
2025-04-01 10:26:38,330 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-01 10:26:38,331 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-01 10:26:38,332 - INFO - Starte detaillierte Modellevaluierung...
2025-04-01 10:26:38,400 - INFO - 
==================================================
2025-04-01 10:26:38,400 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-01 10:26:38,400 - INFO - ==================================================
2025-04-01 10:26:38,400 - INFO - Gesamtgenauigkeit: 25.00%
2025-04-01 10:26:38,400 - INFO - Makro-Präzision: 0.0417
2025-04-01 10:26:38,400 - INFO - Makro-Recall: 0.1667
2025-04-01 10:26:38,400 - INFO - Makro-F1: 0.0667
2025-04-01 10:26:38,400 - INFO - Mikro-F1 (Genauigkeit): 0.2500
2025-04-01 10:26:38,400 - INFO - 
Klassenweise Leistung:
2025-04-01 10:26:38,400 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-01 10:26:38,400 - INFO - ------------------------------------------------------------
2025-04-01 10:26:38,400 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-01 10:26:38,400 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-01 10:26:38,400 - INFO - combined        0.2500      1.0000      0.4000      3
2025-04-01 10:26:38,400 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-01 10:26:38,400 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-01 10:26:38,400 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-01 10:26:38,400 - INFO - 
Top-5 häufigste Fehler:
2025-04-01 10:26:38,400 - INFO - 1. basic als combined klassifiziert: 8 Fälle
2025-04-01 10:26:38,400 - INFO - 2. mixed als combined klassifiziert: 1 Fälle
2025-04-01 10:26:38,400 - INFO - 
Konfusionsmatrix:
2025-04-01 10:26:38,400 - INFO -     0     0     8     0     0     0
    0     0     0     0     0     0
    0     0     3     0     0     0
    0     0     1     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-01 10:26:38,400 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-01 10:26:38,401 - INFO - Erstelle Visualisierungen...
2025-04-01 10:26:39,164 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-01 10:26:39,164 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-01 10:26:39,164 - ERROR - Fehler im Optimierungsprozess: cannot access local variable 'torch' where it is not associated with a value
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1841, in main
    quantization_results = calibrate_and_quantize(trained_model, train_loader, config, class_names)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1045, in calibrate_and_quantize
    with torch.no_grad():
         ^^^^^
UnboundLocalError: cannot access local variable 'torch' where it is not associated with a value
2025-04-02 06:53:31,479 - INFO - ================================================================================
2025-04-02 06:53:31,479 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 06:53:31,479 - INFO - ================================================================================
2025-04-02 06:53:31,479 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 06:53:31,479 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 06:53:31,479 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 06:53:31,479 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 06:53:31,479 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 06:53:31,479 - INFO - ================================================================================
2025-04-02 06:53:31,479 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 06:53:31,531 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 06:53:31,531 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 06:53:31,531 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 06:53:31,531 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 06:53:31,531 - INFO - RGB-Mittelwerte: [0.4742, 0.3938, 0.3252]
2025-04-02 06:53:31,531 - INFO - RGB-Standardabweichungen: [0.2349, 0.2519, 0.2655]
2025-04-02 06:53:31,531 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 06:53:31,531 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47423846 0.39383401 0.32520295], std=[0.23485124 0.25190109 0.26554534]
2025-04-02 06:53:31,532 - INFO - Klassenverteilung (train):
2025-04-02 06:53:31,532 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 06:53:31,532 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 06:53:31,532 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 06:53:31,532 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 06:53:31,533 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 06:53:31,534 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 06:53:31,606 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 06:53:32,000 - INFO - Speicheranalyse:
2025-04-02 06:53:32,000 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:53:32,000 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:53:32,000 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:53:32,001 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:53:32,001 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:53:32,001 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 06:53:32,002 - INFO - Speicheranalyse:
2025-04-02 06:53:32,002 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:53:32,002 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:53:32,002 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:53:32,002 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:53:32,002 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:53:32,056 - INFO - Klassengewichte für Loss-Funktion: [0.75, 0.75, 0.47, 0.83, 1.0, 1.0]
2025-04-02 06:53:32,579 - INFO - Epoch 1/50 - Train Loss: 1.7853, Train Acc: 26.67% - Val Loss: 1.7956, Val Acc: 0.00%
2025-04-02 06:53:32,579 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:32,579 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:32,579 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:32,579 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:32,695 - INFO - Epoch 2/50 - Train Loss: 1.8060, Train Acc: 22.22% - Val Loss: 1.7950, Val Acc: 0.00%
2025-04-02 06:53:32,695 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:32,695 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:32,695 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:32,695 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:32,695 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:53:32,821 - INFO - Epoch 3/50 - Train Loss: 1.7582, Train Acc: 51.11% - Val Loss: 1.7952, Val Acc: 0.00%
2025-04-02 06:53:32,821 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:32,821 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:32,821 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:32,821 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:32,821 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:53:32,934 - INFO - Epoch 4/50 - Train Loss: 1.7771, Train Acc: 35.56% - Val Loss: 1.7950, Val Acc: 0.00%
2025-04-02 06:53:32,934 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:32,934 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:32,934 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:32,934 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:32,934 - INFO - EarlyStopping counter: 3/10
2025-04-02 06:53:33,054 - INFO - Epoch 5/50 - Train Loss: 1.7852, Train Acc: 22.22% - Val Loss: 1.7897, Val Acc: 0.00%
2025-04-02 06:53:33,054 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,054 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,054 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,054 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,057 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 06:53:33,191 - INFO - Epoch 6/50 - Train Loss: 1.7557, Train Acc: 24.44% - Val Loss: 1.7790, Val Acc: 0.00%
2025-04-02 06:53:33,191 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,191 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,191 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,191 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,314 - INFO - Epoch 7/50 - Train Loss: 1.7562, Train Acc: 20.00% - Val Loss: 1.7664, Val Acc: 0.00%
2025-04-02 06:53:33,314 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,314 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,314 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,314 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,429 - INFO - Epoch 8/50 - Train Loss: 1.7334, Train Acc: 26.67% - Val Loss: 1.7439, Val Acc: 0.00%
2025-04-02 06:53:33,429 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,429 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,429 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,429 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,559 - INFO - Epoch 9/50 - Train Loss: 1.6905, Train Acc: 40.00% - Val Loss: 1.7212, Val Acc: 0.00%
2025-04-02 06:53:33,559 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,559 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,559 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,559 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,677 - INFO - Epoch 10/50 - Train Loss: 1.6946, Train Acc: 31.11% - Val Loss: 1.7021, Val Acc: 0.00%
2025-04-02 06:53:33,677 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,677 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,677 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,677 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,678 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 06:53:33,799 - INFO - Epoch 11/50 - Train Loss: 1.6935, Train Acc: 15.56% - Val Loss: 1.6856, Val Acc: 0.00%
2025-04-02 06:53:33,799 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,799 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,799 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,799 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:33,917 - INFO - Epoch 12/50 - Train Loss: 1.6152, Train Acc: 26.67% - Val Loss: 1.6731, Val Acc: 0.00%
2025-04-02 06:53:33,917 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:33,917 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:33,917 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:33,917 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,051 - INFO - Epoch 13/50 - Train Loss: 1.5925, Train Acc: 26.67% - Val Loss: 1.6644, Val Acc: 0.00%
2025-04-02 06:53:34,051 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,051 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,051 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,051 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,169 - INFO - Epoch 14/50 - Train Loss: 1.6032, Train Acc: 17.78% - Val Loss: 1.6521, Val Acc: 0.00%
2025-04-02 06:53:34,169 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,169 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,169 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,169 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,286 - INFO - Epoch 15/50 - Train Loss: 1.5543, Train Acc: 33.33% - Val Loss: 1.6308, Val Acc: 0.00%
2025-04-02 06:53:34,286 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,286 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,286 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,286 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,288 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 06:53:34,410 - INFO - Epoch 16/50 - Train Loss: 1.4860, Train Acc: 26.67% - Val Loss: 1.6379, Val Acc: 0.00%
2025-04-02 06:53:34,411 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,411 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,411 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,411 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,411 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:53:34,535 - INFO - Epoch 17/50 - Train Loss: 1.5059, Train Acc: 31.11% - Val Loss: 1.6655, Val Acc: 0.00%
2025-04-02 06:53:34,535 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,535 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,535 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,535 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,535 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:53:34,658 - INFO - Epoch 18/50 - Train Loss: 1.4918, Train Acc: 17.78% - Val Loss: 1.6414, Val Acc: 0.00%
2025-04-02 06:53:34,658 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,658 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,658 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,658 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,658 - INFO - EarlyStopping counter: 3/10
2025-04-02 06:53:34,658 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:53:34,778 - INFO - Epoch 19/50 - Train Loss: 1.4827, Train Acc: 20.00% - Val Loss: 1.6229, Val Acc: 0.00%
2025-04-02 06:53:34,778 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,778 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,778 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,778 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,899 - INFO - Epoch 20/50 - Train Loss: 1.4712, Train Acc: 28.89% - Val Loss: 1.6249, Val Acc: 0.00%
2025-04-02 06:53:34,899 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:34,899 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:34,899 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:34,899 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:34,899 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:53:34,900 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 06:53:35,020 - INFO - Epoch 21/50 - Train Loss: 1.4516, Train Acc: 31.11% - Val Loss: 1.6521, Val Acc: 0.00%
2025-04-02 06:53:35,020 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:35,020 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:35,020 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:35,020 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:35,020 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:53:35,145 - INFO - Epoch 22/50 - Train Loss: 1.3889, Train Acc: 37.78% - Val Loss: 1.6810, Val Acc: 0.00%
2025-04-02 06:53:35,145 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:35,145 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:35,145 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:35,145 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:35,145 - INFO - EarlyStopping counter: 3/10
2025-04-02 06:53:35,145 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:53:35,274 - INFO - Epoch 23/50 - Train Loss: 1.4172, Train Acc: 35.56% - Val Loss: 1.6903, Val Acc: 0.00%
2025-04-02 06:53:35,274 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:35,274 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:35,274 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:35,274 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:35,274 - INFO - EarlyStopping counter: 9/10
2025-04-02 06:53:35,274 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:53:35,396 - INFO - Epoch 24/50 - Train Loss: 1.4000, Train Acc: 28.89% - Val Loss: 1.6790, Val Acc: 0.00%
2025-04-02 06:53:35,396 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:53:35,396 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:53:35,396 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:53:35,396 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:53:35,397 - INFO - EarlyStopping counter: 10/10
2025-04-02 06:53:35,397 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:53:35,397 - INFO - Early Stopping in Epoche 24
2025-04-02 06:53:35,397 - INFO - Training abgeschlossen in 3.34 Sekunden
2025-04-02 06:53:35,397 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 06:53:35,398 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 06:53:35,399 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 06:53:35,459 - INFO - 
==================================================
2025-04-02 06:53:35,459 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 06:53:35,459 - INFO - ==================================================
2025-04-02 06:53:35,459 - INFO - Gesamtgenauigkeit: 0.00%
2025-04-02 06:53:35,459 - INFO - Makro-Präzision: 0.0000
2025-04-02 06:53:35,459 - INFO - Makro-Recall: 0.0000
2025-04-02 06:53:35,459 - INFO - Makro-F1: 0.0000
2025-04-02 06:53:35,459 - INFO - Mikro-F1 (Genauigkeit): 0.0000
2025-04-02 06:53:35,459 - INFO - 
Klassenweise Leistung:
2025-04-02 06:53:35,459 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 06:53:35,459 - INFO - ------------------------------------------------------------
2025-04-02 06:53:35,459 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 06:53:35,459 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 06:53:35,459 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 06:53:35,459 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 06:53:35,459 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 06:53:35,460 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 06:53:35,460 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 06:53:35,460 - INFO - 1. basic als burnt klassifiziert: 8 Fälle
2025-04-02 06:53:35,460 - INFO - 2. combined als burnt klassifiziert: 3 Fälle
2025-04-02 06:53:35,460 - INFO - 3. mixed als burnt klassifiziert: 1 Fälle
2025-04-02 06:53:35,460 - INFO - 
Konfusionsmatrix:
2025-04-02 06:53:35,460 - INFO -     0     8     0     0     0     0
    0     0     0     0     0     0
    0     3     0     0     0     0
    0     1     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 06:53:35,460 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 06:53:35,460 - INFO - Erstelle Visualisierungen...
2025-04-02 06:53:36,309 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 06:53:36,310 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 06:53:36,310 - ERROR - Fehler im Optimierungsprozess: cannot access local variable 'torch' where it is not associated with a value
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1841, in main
    quantization_results = calibrate_and_quantize(trained_model, train_loader, config, class_names)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1045, in calibrate_and_quantize
    with torch.no_grad():
         ^^^^^
UnboundLocalError: cannot access local variable 'torch' where it is not associated with a value
2025-04-02 06:56:00,814 - INFO - ================================================================================
2025-04-02 06:56:00,814 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 06:56:00,814 - INFO - ================================================================================
2025-04-02 06:56:00,814 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 06:56:00,814 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 06:56:00,814 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 06:56:00,814 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 06:56:00,814 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 06:56:00,814 - INFO - ================================================================================
2025-04-02 06:56:00,814 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 06:56:00,846 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 06:56:00,846 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 06:56:00,846 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 06:56:00,846 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 06:56:00,846 - INFO - RGB-Mittelwerte: [0.4866, 0.4017, 0.3349]
2025-04-02 06:56:00,846 - INFO - RGB-Standardabweichungen: [0.2395, 0.2554, 0.2667]
2025-04-02 06:56:00,846 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 06:56:00,846 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.48662212 0.40169321 0.33489261], std=[0.23952605 0.25542872 0.2667296 ]
2025-04-02 06:56:00,847 - INFO - Klassenverteilung (train):
2025-04-02 06:56:00,847 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 06:56:00,847 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 06:56:00,847 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 06:56:00,847 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 06:56:00,847 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 06:56:00,847 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 06:56:00,906 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 06:56:01,022 - INFO - Speicheranalyse:
2025-04-02 06:56:01,022 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:56:01,022 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:56:01,022 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:56:01,023 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:56:01,023 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:56:01,023 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 06:56:01,023 - INFO - Speicheranalyse:
2025-04-02 06:56:01,024 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:56:01,024 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:56:01,024 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:56:01,024 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:56:01,024 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:56:01,079 - INFO - Klassengewichte für Loss-Funktion: [0.62, 0.44, 0.62, 1.88, 1.0, 1.0]
2025-04-02 06:56:01,345 - INFO - Epoch 1/50 - Train Loss: 1.7977, Train Acc: 20.00% - Val Loss: 1.7944, Val Acc: 16.67%
2025-04-02 06:56:01,345 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,345 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,345 - INFO -   combined: 66.67% (2/3)
2025-04-02 06:56:01,345 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:01,347 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-02 06:56:01,474 - INFO - Epoch 2/50 - Train Loss: 1.8000, Train Acc: 13.33% - Val Loss: 1.7936, Val Acc: 25.00%
2025-04-02 06:56:01,475 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,475 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,475 - INFO -   combined: 100.00% (3/3)
2025-04-02 06:56:01,475 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:01,475 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:56:01,476 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch2.pth
2025-04-02 06:56:01,602 - INFO - Epoch 3/50 - Train Loss: 1.7941, Train Acc: 13.33% - Val Loss: 1.7909, Val Acc: 16.67%
2025-04-02 06:56:01,602 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,602 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,602 - INFO -   combined: 66.67% (2/3)
2025-04-02 06:56:01,602 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:01,732 - INFO - Epoch 4/50 - Train Loss: 1.7913, Train Acc: 26.67% - Val Loss: 1.7884, Val Acc: 8.33%
2025-04-02 06:56:01,732 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,732 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,732 - INFO -   combined: 33.33% (1/3)
2025-04-02 06:56:01,732 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:01,860 - INFO - Epoch 5/50 - Train Loss: 1.7839, Train Acc: 26.67% - Val Loss: 1.7836, Val Acc: 0.00%
2025-04-02 06:56:01,860 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,860 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,860 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:01,860 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:01,861 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 06:56:01,992 - INFO - Epoch 6/50 - Train Loss: 1.7641, Train Acc: 33.33% - Val Loss: 1.7742, Val Acc: 8.33%
2025-04-02 06:56:01,992 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:01,992 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:01,992 - INFO -   combined: 33.33% (1/3)
2025-04-02 06:56:01,992 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:02,122 - INFO - Epoch 7/50 - Train Loss: 1.7618, Train Acc: 17.78% - Val Loss: 1.7602, Val Acc: 0.00%
2025-04-02 06:56:02,122 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,122 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,122 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,122 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:56:02,252 - INFO - Epoch 8/50 - Train Loss: 1.7308, Train Acc: 35.56% - Val Loss: 1.7451, Val Acc: 8.33%
2025-04-02 06:56:02,252 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,252 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,252 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,252 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:02,370 - INFO - Epoch 9/50 - Train Loss: 1.6966, Train Acc: 42.22% - Val Loss: 1.7223, Val Acc: 8.33%
2025-04-02 06:56:02,370 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,370 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,370 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,370 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:02,510 - INFO - Epoch 10/50 - Train Loss: 1.6741, Train Acc: 33.33% - Val Loss: 1.7065, Val Acc: 8.33%
2025-04-02 06:56:02,510 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,510 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,510 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,510 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:02,512 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 06:56:02,633 - INFO - Epoch 11/50 - Train Loss: 1.6471, Train Acc: 22.22% - Val Loss: 1.6939, Val Acc: 8.33%
2025-04-02 06:56:02,633 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,633 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,633 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,633 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:02,764 - INFO - Epoch 12/50 - Train Loss: 1.6340, Train Acc: 24.44% - Val Loss: 1.6877, Val Acc: 8.33%
2025-04-02 06:56:02,764 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,764 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,764 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,764 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:02,895 - INFO - Epoch 13/50 - Train Loss: 1.5493, Train Acc: 31.11% - Val Loss: 1.6815, Val Acc: 8.33%
2025-04-02 06:56:02,895 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:02,895 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:02,895 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:02,895 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,018 - INFO - Epoch 14/50 - Train Loss: 1.5231, Train Acc: 26.67% - Val Loss: 1.6959, Val Acc: 8.33%
2025-04-02 06:56:03,018 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,018 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,018 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,018 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,018 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:56:03,141 - INFO - Epoch 15/50 - Train Loss: 1.5218, Train Acc: 20.00% - Val Loss: 1.6877, Val Acc: 8.33%
2025-04-02 06:56:03,141 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,141 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,141 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,141 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,141 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:56:03,142 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 06:56:03,281 - INFO - Epoch 16/50 - Train Loss: 1.5855, Train Acc: 13.33% - Val Loss: 1.6592, Val Acc: 8.33%
2025-04-02 06:56:03,281 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,281 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,281 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,281 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,408 - INFO - Epoch 17/50 - Train Loss: 1.4215, Train Acc: 24.44% - Val Loss: 1.5937, Val Acc: 8.33%
2025-04-02 06:56:03,408 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,408 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,408 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,408 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,541 - INFO - Epoch 18/50 - Train Loss: 1.4390, Train Acc: 20.00% - Val Loss: 1.5427, Val Acc: 8.33%
2025-04-02 06:56:03,541 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,541 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,541 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,541 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,661 - INFO - Epoch 19/50 - Train Loss: 1.5014, Train Acc: 15.56% - Val Loss: 1.5186, Val Acc: 8.33%
2025-04-02 06:56:03,661 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,661 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,661 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,661 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,780 - INFO - Epoch 20/50 - Train Loss: 1.2831, Train Acc: 31.11% - Val Loss: 1.5043, Val Acc: 8.33%
2025-04-02 06:56:03,781 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,781 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,781 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,781 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,783 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 06:56:03,905 - INFO - Epoch 21/50 - Train Loss: 1.3318, Train Acc: 28.89% - Val Loss: 1.5106, Val Acc: 8.33%
2025-04-02 06:56:03,905 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:03,905 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:03,905 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:03,905 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:03,905 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:56:04,022 - INFO - Epoch 22/50 - Train Loss: 1.2581, Train Acc: 24.44% - Val Loss: 1.5183, Val Acc: 8.33%
2025-04-02 06:56:04,022 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:04,022 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:04,022 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:04,022 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:04,022 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:56:04,151 - INFO - Epoch 23/50 - Train Loss: 1.1682, Train Acc: 37.78% - Val Loss: 1.5545, Val Acc: 8.33%
2025-04-02 06:56:04,151 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:04,151 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:04,151 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:04,151 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:04,151 - INFO - EarlyStopping counter: 3/10
2025-04-02 06:56:04,151 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:56:04,281 - INFO - Epoch 24/50 - Train Loss: 1.3170, Train Acc: 24.44% - Val Loss: 1.5544, Val Acc: 8.33%
2025-04-02 06:56:04,281 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:04,281 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:04,281 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:04,281 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:04,281 - INFO - EarlyStopping counter: 9/10
2025-04-02 06:56:04,281 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:56:04,409 - INFO - Epoch 25/50 - Train Loss: 1.1221, Train Acc: 33.33% - Val Loss: 1.6323, Val Acc: 8.33%
2025-04-02 06:56:04,409 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:56:04,409 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:56:04,409 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:56:04,410 - INFO -   mixed: 100.00% (1/1)
2025-04-02 06:56:04,410 - INFO - EarlyStopping counter: 10/10
2025-04-02 06:56:04,410 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:56:04,411 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-02 06:56:04,411 - INFO - Early Stopping in Epoche 25
2025-04-02 06:56:04,411 - INFO - Training abgeschlossen in 3.33 Sekunden
2025-04-02 06:56:04,411 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 06:56:04,412 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 06:56:04,412 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 06:56:04,472 - INFO - 
==================================================
2025-04-02 06:56:04,472 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 06:56:04,472 - INFO - ==================================================
2025-04-02 06:56:04,472 - INFO - Gesamtgenauigkeit: 8.33%
2025-04-02 06:56:04,472 - INFO - Makro-Präzision: 0.0139
2025-04-02 06:56:04,472 - INFO - Makro-Recall: 0.1667
2025-04-02 06:56:04,472 - INFO - Makro-F1: 0.0256
2025-04-02 06:56:04,472 - INFO - Mikro-F1 (Genauigkeit): 0.0833
2025-04-02 06:56:04,472 - INFO - 
Klassenweise Leistung:
2025-04-02 06:56:04,472 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 06:56:04,472 - INFO - ------------------------------------------------------------
2025-04-02 06:56:04,472 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 06:56:04,472 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 06:56:04,472 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 06:56:04,472 - INFO - mixed           0.0833      1.0000      0.1538      1
2025-04-02 06:56:04,472 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 06:56:04,472 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 06:56:04,472 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 06:56:04,472 - INFO - 1. basic als mixed klassifiziert: 8 Fälle
2025-04-02 06:56:04,472 - INFO - 2. combined als mixed klassifiziert: 3 Fälle
2025-04-02 06:56:04,472 - INFO - 
Konfusionsmatrix:
2025-04-02 06:56:04,472 - INFO -     0     0     0     8     0     0
    0     0     0     0     0     0
    0     0     0     3     0     0
    0     0     0     1     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 06:56:04,472 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 06:56:04,472 - INFO - Erstelle Visualisierungen...
2025-04-02 06:56:05,247 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 06:56:05,248 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 06:56:05,310 - INFO - Kalibrierung mit 37 repräsentativen Samples
2025-04-02 06:56:05,730 - ERROR - Fehler bei der Modellquantisierung: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 06:56:05,730 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 06:56:05,731 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1844, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1151, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 06:58:21,198 - INFO - ================================================================================
2025-04-02 06:58:21,198 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 06:58:21,198 - INFO - ================================================================================
2025-04-02 06:58:21,198 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 06:58:21,198 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 06:58:21,198 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 06:58:21,198 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 06:58:21,198 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 06:58:21,198 - INFO - ================================================================================
2025-04-02 06:58:21,198 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 06:58:21,231 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 06:58:21,231 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 06:58:21,231 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 06:58:21,232 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 06:58:21,232 - INFO - RGB-Mittelwerte: [0.4894, 0.4044, 0.3326]
2025-04-02 06:58:21,232 - INFO - RGB-Standardabweichungen: [0.2397, 0.2573, 0.2696]
2025-04-02 06:58:21,232 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 06:58:21,232 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.48938227 0.40436151 0.33263671], std=[0.23973924 0.25734597 0.26963938]
2025-04-02 06:58:21,232 - INFO - Klassenverteilung (train):
2025-04-02 06:58:21,232 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 06:58:21,232 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 06:58:21,232 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 06:58:21,232 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 06:58:21,233 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 06:58:21,233 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 06:58:21,315 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 06:58:21,434 - INFO - Speicheranalyse:
2025-04-02 06:58:21,434 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:58:21,434 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:58:21,434 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:58:21,434 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:58:21,434 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:58:21,434 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 06:58:21,435 - INFO - Speicheranalyse:
2025-04-02 06:58:21,435 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 06:58:21,435 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 06:58:21,435 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 06:58:21,435 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 06:58:21,435 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 06:58:21,494 - INFO - Klassengewichte für Loss-Funktion: [0.68, 0.94, 0.54, 0.62, 1.0, 1.0]
2025-04-02 06:58:21,753 - INFO - Epoch 1/50 - Train Loss: 1.7828, Train Acc: 20.00% - Val Loss: 1.8291, Val Acc: 0.00%
2025-04-02 06:58:21,753 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:21,753 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:21,753 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:21,753 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:21,869 - INFO - Epoch 2/50 - Train Loss: 1.7864, Train Acc: 26.67% - Val Loss: 1.8368, Val Acc: 0.00%
2025-04-02 06:58:21,869 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:21,869 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:21,869 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:21,869 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:21,870 - INFO - EarlyStopping counter: 1/10
2025-04-02 06:58:21,986 - INFO - Epoch 3/50 - Train Loss: 1.7781, Train Acc: 46.67% - Val Loss: 1.8464, Val Acc: 0.00%
2025-04-02 06:58:21,987 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:21,987 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:21,987 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:21,987 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:21,987 - INFO - EarlyStopping counter: 2/10
2025-04-02 06:58:22,111 - INFO - Epoch 4/50 - Train Loss: 1.7710, Train Acc: 42.22% - Val Loss: 1.8549, Val Acc: 0.00%
2025-04-02 06:58:22,111 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:22,111 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:22,111 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:22,111 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:22,111 - INFO - EarlyStopping counter: 3/10
2025-04-02 06:58:22,234 - INFO - Epoch 5/50 - Train Loss: 1.7789, Train Acc: 22.22% - Val Loss: 1.8530, Val Acc: 0.00%
2025-04-02 06:58:22,234 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:22,234 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:22,234 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:22,234 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:22,234 - INFO - EarlyStopping counter: 4/10
2025-04-02 06:58:22,234 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:58:22,237 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 06:58:22,359 - INFO - Epoch 6/50 - Train Loss: 1.7601, Train Acc: 31.11% - Val Loss: 1.8678, Val Acc: 0.00%
2025-04-02 06:58:22,359 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:22,359 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:22,359 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:22,359 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:22,359 - INFO - EarlyStopping counter: 9/10
2025-04-02 06:58:22,359 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 06:58:22,484 - INFO - Epoch 7/50 - Train Loss: 1.7356, Train Acc: 40.00% - Val Loss: 1.8674, Val Acc: 0.00%
2025-04-02 06:58:22,484 - INFO - Klassenweise Genauigkeiten:
2025-04-02 06:58:22,484 - INFO -   basic: 0.00% (0/8)
2025-04-02 06:58:22,484 - INFO -   combined: 0.00% (0/3)
2025-04-02 06:58:22,484 - INFO -   mixed: 0.00% (0/1)
2025-04-02 06:58:22,484 - INFO - EarlyStopping counter: 10/10
2025-04-02 06:58:22,484 - INFO - Early Stopping in Epoche 7
2025-04-02 06:58:22,484 - INFO - Training abgeschlossen in 0.99 Sekunden
2025-04-02 06:58:22,484 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 06:58:22,486 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 06:58:22,486 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 06:58:22,543 - INFO - 
==================================================
2025-04-02 06:58:22,543 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 06:58:22,543 - INFO - ==================================================
2025-04-02 06:58:22,543 - INFO - Gesamtgenauigkeit: 0.00%
2025-04-02 06:58:22,543 - INFO - Makro-Präzision: 0.0000
2025-04-02 06:58:22,543 - INFO - Makro-Recall: 0.0000
2025-04-02 06:58:22,543 - INFO - Makro-F1: 0.0000
2025-04-02 06:58:22,544 - INFO - Mikro-F1 (Genauigkeit): 0.0000
2025-04-02 06:58:22,544 - INFO - 
Klassenweise Leistung:
2025-04-02 06:58:22,544 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 06:58:22,544 - INFO - ------------------------------------------------------------
2025-04-02 06:58:22,544 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 06:58:22,544 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 06:58:22,544 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 06:58:22,544 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 06:58:22,544 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 06:58:22,544 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 06:58:22,544 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 06:58:22,544 - INFO - 1. basic als burnt klassifiziert: 8 Fälle
2025-04-02 06:58:22,544 - INFO - 2. combined als burnt klassifiziert: 3 Fälle
2025-04-02 06:58:22,544 - INFO - 3. mixed als burnt klassifiziert: 1 Fälle
2025-04-02 06:58:22,544 - INFO - 
Konfusionsmatrix:
2025-04-02 06:58:22,544 - INFO -     0     8     0     0     0     0
    0     0     0     0     0     0
    0     3     0     0     0     0
    0     1     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 06:58:22,544 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 06:58:22,544 - INFO - Erstelle Visualisierungen...
2025-04-02 06:58:23,275 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 06:58:23,275 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 06:58:23,340 - INFO - Kalibrierung mit 35 repräsentativen Samples
2025-04-02 06:58:23,687 - ERROR - Fehler bei der Modellquantisierung: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 06:58:23,687 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 06:58:23,688 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1844, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1151, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:02:44,279 - INFO - ================================================================================
2025-04-02 07:02:44,279 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:02:44,279 - INFO - ================================================================================
2025-04-02 07:02:44,279 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:02:44,279 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:02:44,279 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:02:44,279 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:02:44,279 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:02:44,279 - INFO - ================================================================================
2025-04-02 07:02:44,279 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:02:44,313 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:02:44,313 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:02:44,313 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:02:44,313 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:02:44,313 - INFO - RGB-Mittelwerte: [0.4793, 0.4011, 0.3305]
2025-04-02 07:02:44,313 - INFO - RGB-Standardabweichungen: [0.2345, 0.2543, 0.2654]
2025-04-02 07:02:44,313 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:02:44,314 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47932329 0.40109826 0.33052925], std=[0.234542   0.25432107 0.26538155]
2025-04-02 07:02:44,314 - INFO - Klassenverteilung (train):
2025-04-02 07:02:44,314 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:02:44,314 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:02:44,314 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:02:44,314 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:02:44,315 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:02:44,315 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:02:44,375 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:02:44,487 - INFO - Speicheranalyse:
2025-04-02 07:02:44,487 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:02:44,487 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:02:44,487 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:02:44,487 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:02:44,487 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:02:44,487 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:02:44,488 - INFO - Speicheranalyse:
2025-04-02 07:02:44,488 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:02:44,488 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:02:44,488 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:02:44,488 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:02:44,488 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:02:44,547 - INFO - Klassengewichte für Loss-Funktion: [0.68, 0.62, 0.47, 1.25, 1.0, 1.0]
2025-04-02 07:02:44,794 - INFO - Epoch 1/50 - Train Loss: 1.7969, Train Acc: 15.56% - Val Loss: 1.7880, Val Acc: 0.00%
2025-04-02 07:02:44,794 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:44,794 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:44,794 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:44,794 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:44,915 - INFO - Epoch 2/50 - Train Loss: 1.7922, Train Acc: 31.11% - Val Loss: 1.7854, Val Acc: 0.00%
2025-04-02 07:02:44,916 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:44,916 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:44,916 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:44,916 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,041 - INFO - Epoch 3/50 - Train Loss: 1.7823, Train Acc: 24.44% - Val Loss: 1.7819, Val Acc: 0.00%
2025-04-02 07:02:45,041 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,041 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,041 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,041 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,161 - INFO - Epoch 4/50 - Train Loss: 1.7764, Train Acc: 26.67% - Val Loss: 1.7766, Val Acc: 0.00%
2025-04-02 07:02:45,161 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,161 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,161 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,161 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,293 - INFO - Epoch 5/50 - Train Loss: 1.7762, Train Acc: 20.00% - Val Loss: 1.7627, Val Acc: 0.00%
2025-04-02 07:02:45,293 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,293 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,293 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,293 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,295 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:02:45,413 - INFO - Epoch 6/50 - Train Loss: 1.7642, Train Acc: 26.67% - Val Loss: 1.7524, Val Acc: 0.00%
2025-04-02 07:02:45,413 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,413 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,413 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,413 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,546 - INFO - Epoch 7/50 - Train Loss: 1.7506, Train Acc: 31.11% - Val Loss: 1.7324, Val Acc: 0.00%
2025-04-02 07:02:45,546 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,546 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,546 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,546 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:02:45,664 - INFO - Epoch 8/50 - Train Loss: 1.7325, Train Acc: 22.22% - Val Loss: 1.7145, Val Acc: 8.33%
2025-04-02 07:02:45,664 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,664 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,664 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,664 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:45,666 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch8.pth
2025-04-02 07:02:45,790 - INFO - Epoch 9/50 - Train Loss: 1.6992, Train Acc: 35.56% - Val Loss: 1.6831, Val Acc: 8.33%
2025-04-02 07:02:45,790 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,790 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,790 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,790 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:45,907 - INFO - Epoch 10/50 - Train Loss: 1.6755, Train Acc: 24.44% - Val Loss: 1.6541, Val Acc: 8.33%
2025-04-02 07:02:45,907 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:45,907 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:45,907 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:45,907 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:45,909 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:02:46,040 - INFO - Epoch 11/50 - Train Loss: 1.6467, Train Acc: 28.89% - Val Loss: 1.6180, Val Acc: 8.33%
2025-04-02 07:02:46,041 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,041 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,041 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,041 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,162 - INFO - Epoch 12/50 - Train Loss: 1.6646, Train Acc: 15.56% - Val Loss: 1.5888, Val Acc: 8.33%
2025-04-02 07:02:46,162 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,162 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,162 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,162 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,287 - INFO - Epoch 13/50 - Train Loss: 1.6377, Train Acc: 13.33% - Val Loss: 1.5724, Val Acc: 8.33%
2025-04-02 07:02:46,287 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,287 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,288 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,288 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,411 - INFO - Epoch 14/50 - Train Loss: 1.5207, Train Acc: 35.56% - Val Loss: 1.5526, Val Acc: 8.33%
2025-04-02 07:02:46,411 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,411 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,411 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,411 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,530 - INFO - Epoch 15/50 - Train Loss: 1.5131, Train Acc: 22.22% - Val Loss: 1.5206, Val Acc: 8.33%
2025-04-02 07:02:46,530 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,530 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,531 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,531 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,532 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:02:46,649 - INFO - Epoch 16/50 - Train Loss: 1.5100, Train Acc: 22.22% - Val Loss: 1.4885, Val Acc: 8.33%
2025-04-02 07:02:46,650 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,650 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,650 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,650 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,788 - INFO - Epoch 17/50 - Train Loss: 1.5630, Train Acc: 17.78% - Val Loss: 1.4927, Val Acc: 8.33%
2025-04-02 07:02:46,788 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,788 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,788 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,788 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,788 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:02:46,916 - INFO - Epoch 18/50 - Train Loss: 1.5387, Train Acc: 15.56% - Val Loss: 1.5146, Val Acc: 8.33%
2025-04-02 07:02:46,916 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:46,916 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:46,916 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:46,916 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:46,916 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:02:47,029 - INFO - Epoch 19/50 - Train Loss: 1.4169, Train Acc: 28.89% - Val Loss: 1.4924, Val Acc: 8.33%
2025-04-02 07:02:47,029 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:47,029 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:47,029 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:47,029 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:47,029 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:02:47,029 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:02:47,152 - INFO - Epoch 20/50 - Train Loss: 1.4236, Train Acc: 24.44% - Val Loss: 1.4960, Val Acc: 8.33%
2025-04-02 07:02:47,152 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:47,153 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:47,153 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:47,153 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:47,153 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:02:47,154 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 07:02:47,278 - INFO - Epoch 21/50 - Train Loss: 1.3436, Train Acc: 35.56% - Val Loss: 1.4920, Val Acc: 8.33%
2025-04-02 07:02:47,278 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:02:47,278 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:02:47,278 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:02:47,278 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:02:47,278 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:02:47,278 - INFO - Early Stopping in Epoche 21
2025-04-02 07:02:47,278 - INFO - Training abgeschlossen in 2.73 Sekunden
2025-04-02 07:02:47,279 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:02:47,280 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:02:47,280 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:02:47,360 - INFO - 
==================================================
2025-04-02 07:02:47,361 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:02:47,361 - INFO - ==================================================
2025-04-02 07:02:47,361 - INFO - Gesamtgenauigkeit: 8.33%
2025-04-02 07:02:47,361 - INFO - Makro-Präzision: 0.0139
2025-04-02 07:02:47,361 - INFO - Makro-Recall: 0.1667
2025-04-02 07:02:47,361 - INFO - Makro-F1: 0.0256
2025-04-02 07:02:47,361 - INFO - Mikro-F1 (Genauigkeit): 0.0833
2025-04-02 07:02:47,361 - INFO - 
Klassenweise Leistung:
2025-04-02 07:02:47,361 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:02:47,361 - INFO - ------------------------------------------------------------
2025-04-02 07:02:47,361 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 07:02:47,361 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:02:47,361 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 07:02:47,361 - INFO - mixed           0.0833      1.0000      0.1538      1
2025-04-02 07:02:47,361 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:02:47,361 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:02:47,361 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:02:47,361 - INFO - 1. basic als mixed klassifiziert: 8 Fälle
2025-04-02 07:02:47,361 - INFO - 2. combined als mixed klassifiziert: 3 Fälle
2025-04-02 07:02:47,361 - INFO - 
Konfusionsmatrix:
2025-04-02 07:02:47,361 - INFO -     0     0     0     8     0     0
    0     0     0     0     0     0
    0     0     0     3     0     0
    0     0     0     1     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:02:47,362 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:02:47,362 - INFO - Erstelle Visualisierungen...
2025-04-02 07:02:48,076 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:02:48,076 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:02:48,137 - INFO - Kalibrierung mit 35 repräsentativen Samples
2025-04-02 07:02:48,138 - ERROR - Fehler bei der Modellquantisierung: cannot access local variable 'quantization' where it is not associated with a value
2025-04-02 07:02:48,138 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:02:48,138 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1865, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1172, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:05:34,832 - INFO - ================================================================================
2025-04-02 07:05:34,832 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:05:34,832 - INFO - ================================================================================
2025-04-02 07:05:34,832 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:05:34,832 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:05:34,832 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:05:34,832 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:05:34,832 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:05:34,832 - INFO - ================================================================================
2025-04-02 07:05:34,832 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:05:34,867 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:05:34,867 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:05:34,867 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:05:34,867 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:05:34,867 - INFO - RGB-Mittelwerte: [0.4887, 0.4049, 0.3346]
2025-04-02 07:05:34,867 - INFO - RGB-Standardabweichungen: [0.2391, 0.2558, 0.2682]
2025-04-02 07:05:34,868 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:05:34,868 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.48869142 0.40493296 0.33464737], std=[0.2391379  0.25579795 0.26817225]
2025-04-02 07:05:34,868 - INFO - Klassenverteilung (train):
2025-04-02 07:05:34,868 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:05:34,868 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:05:34,868 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:05:34,868 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:05:34,869 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:05:34,869 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:05:34,934 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:05:35,050 - INFO - Speicheranalyse:
2025-04-02 07:05:35,050 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:05:35,050 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:05:35,050 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:05:35,050 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:05:35,050 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:05:35,050 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:05:35,051 - INFO - Speicheranalyse:
2025-04-02 07:05:35,051 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:05:35,051 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:05:35,051 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:05:35,051 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:05:35,052 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:05:35,111 - INFO - Klassengewichte für Loss-Funktion: [0.58, 0.58, 0.62, 1.07, 1.0, 1.0]
2025-04-02 07:05:35,379 - INFO - Epoch 1/50 - Train Loss: 1.7845, Train Acc: 17.78% - Val Loss: 1.7895, Val Acc: 8.33%
2025-04-02 07:05:35,379 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:35,379 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:35,379 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:35,379 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:35,380 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-02 07:05:35,513 - INFO - Epoch 2/50 - Train Loss: 1.7803, Train Acc: 28.89% - Val Loss: 1.7885, Val Acc: 0.00%
2025-04-02 07:05:35,513 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:35,513 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:35,513 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:35,513 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:05:35,513 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:05:35,642 - INFO - Epoch 3/50 - Train Loss: 1.7838, Train Acc: 22.22% - Val Loss: 1.7865, Val Acc: 0.00%
2025-04-02 07:05:35,642 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:35,642 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:35,642 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:35,642 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:05:35,764 - INFO - Epoch 4/50 - Train Loss: 1.7791, Train Acc: 33.33% - Val Loss: 1.7804, Val Acc: 8.33%
2025-04-02 07:05:35,764 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:35,764 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:35,764 - INFO -   combined: 33.33% (1/3)
2025-04-02 07:05:35,764 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:05:35,888 - INFO - Epoch 5/50 - Train Loss: 1.7676, Train Acc: 33.33% - Val Loss: 1.7676, Val Acc: 8.33%
2025-04-02 07:05:35,888 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:35,888 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:35,888 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:35,888 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:35,890 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:05:36,014 - INFO - Epoch 6/50 - Train Loss: 1.7585, Train Acc: 40.00% - Val Loss: 1.7529, Val Acc: 16.67%
2025-04-02 07:05:36,014 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,014 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,014 - INFO -   combined: 33.33% (1/3)
2025-04-02 07:05:36,014 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,016 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch6.pth
2025-04-02 07:05:36,154 - INFO - Epoch 7/50 - Train Loss: 1.7475, Train Acc: 28.89% - Val Loss: 1.7308, Val Acc: 8.33%
2025-04-02 07:05:36,155 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,155 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,155 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,155 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,289 - INFO - Epoch 8/50 - Train Loss: 1.7394, Train Acc: 17.78% - Val Loss: 1.7061, Val Acc: 8.33%
2025-04-02 07:05:36,289 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,289 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,289 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,289 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,421 - INFO - Epoch 9/50 - Train Loss: 1.7081, Train Acc: 35.56% - Val Loss: 1.6895, Val Acc: 8.33%
2025-04-02 07:05:36,422 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,422 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,422 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,422 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,551 - INFO - Epoch 10/50 - Train Loss: 1.6819, Train Acc: 35.56% - Val Loss: 1.6792, Val Acc: 8.33%
2025-04-02 07:05:36,551 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,551 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,552 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,552 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,553 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:05:36,675 - INFO - Epoch 11/50 - Train Loss: 1.6582, Train Acc: 20.00% - Val Loss: 1.6962, Val Acc: 8.33%
2025-04-02 07:05:36,675 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,675 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,675 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,675 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,675 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:05:36,798 - INFO - Epoch 12/50 - Train Loss: 1.6198, Train Acc: 33.33% - Val Loss: 1.7295, Val Acc: 8.33%
2025-04-02 07:05:36,798 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,798 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,798 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,798 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,798 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:05:36,923 - INFO - Epoch 13/50 - Train Loss: 1.6167, Train Acc: 26.67% - Val Loss: 1.7680, Val Acc: 8.33%
2025-04-02 07:05:36,923 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:36,923 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:36,923 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:36,923 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:36,923 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:05:36,923 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:05:37,061 - INFO - Epoch 14/50 - Train Loss: 1.6119, Train Acc: 15.56% - Val Loss: 1.7561, Val Acc: 8.33%
2025-04-02 07:05:37,061 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:37,061 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:37,061 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:37,061 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:37,061 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:05:37,062 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:05:37,200 - INFO - Epoch 15/50 - Train Loss: 1.5929, Train Acc: 15.56% - Val Loss: 1.7856, Val Acc: 8.33%
2025-04-02 07:05:37,201 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:05:37,201 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:05:37,201 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:05:37,201 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:05:37,201 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:05:37,201 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:05:37,202 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:05:37,202 - INFO - Early Stopping in Epoche 15
2025-04-02 07:05:37,202 - INFO - Training abgeschlossen in 2.09 Sekunden
2025-04-02 07:05:37,202 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:05:37,203 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:05:37,203 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:05:37,263 - INFO - 
==================================================
2025-04-02 07:05:37,263 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:05:37,263 - INFO - ==================================================
2025-04-02 07:05:37,263 - INFO - Gesamtgenauigkeit: 8.33%
2025-04-02 07:05:37,263 - INFO - Makro-Präzision: 0.0139
2025-04-02 07:05:37,263 - INFO - Makro-Recall: 0.1667
2025-04-02 07:05:37,263 - INFO - Makro-F1: 0.0256
2025-04-02 07:05:37,263 - INFO - Mikro-F1 (Genauigkeit): 0.0833
2025-04-02 07:05:37,263 - INFO - 
Klassenweise Leistung:
2025-04-02 07:05:37,263 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:05:37,263 - INFO - ------------------------------------------------------------
2025-04-02 07:05:37,263 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 07:05:37,263 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:05:37,263 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 07:05:37,263 - INFO - mixed           0.0833      1.0000      0.1538      1
2025-04-02 07:05:37,263 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:05:37,263 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:05:37,263 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:05:37,263 - INFO - 1. basic als mixed klassifiziert: 8 Fälle
2025-04-02 07:05:37,263 - INFO - 2. combined als mixed klassifiziert: 3 Fälle
2025-04-02 07:05:37,263 - INFO - 
Konfusionsmatrix:
2025-04-02 07:05:37,263 - INFO -     0     0     0     8     0     0
    0     0     0     0     0     0
    0     0     0     3     0     0
    0     0     0     1     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:05:37,263 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:05:37,263 - INFO - Erstelle Visualisierungen...
2025-04-02 07:05:37,961 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:05:37,961 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:05:38,025 - INFO - Kalibrierung mit 38 repräsentativen Samples
2025-04-02 07:05:38,364 - WARNING - Quantisierung fehlgeschlagen: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 07:05:38,364 - WARNING - Verwende nicht-quantisiertes Modell für Export
2025-04-02 07:05:38,365 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:05:38,366 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1963, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1270, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:07:29,753 - INFO - ================================================================================
2025-04-02 07:07:29,753 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:07:29,753 - INFO - ================================================================================
2025-04-02 07:07:29,753 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:07:29,753 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:07:29,753 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:07:29,753 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:07:29,753 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:07:29,753 - INFO - ================================================================================
2025-04-02 07:07:29,753 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:07:29,786 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:07:29,786 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:07:29,786 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:07:29,786 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:07:29,786 - INFO - RGB-Mittelwerte: [0.4953, 0.4111, 0.3395]
2025-04-02 07:07:29,786 - INFO - RGB-Standardabweichungen: [0.2362, 0.2539, 0.2668]
2025-04-02 07:07:29,786 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:07:29,787 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.49529484 0.41113575 0.33953427], std=[0.23620188 0.25393553 0.26680633]
2025-04-02 07:07:29,787 - INFO - Klassenverteilung (train):
2025-04-02 07:07:29,787 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:07:29,787 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:07:29,787 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:07:29,787 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:07:29,787 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:07:29,788 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:07:29,845 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:07:29,958 - INFO - Speicheranalyse:
2025-04-02 07:07:29,958 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:07:29,958 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:07:29,958 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:07:29,959 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:07:29,959 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:07:29,959 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:07:29,959 - INFO - Speicheranalyse:
2025-04-02 07:07:29,960 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:07:29,960 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:07:29,960 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:07:29,960 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:07:29,960 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:07:30,017 - INFO - Klassengewichte für Loss-Funktion: [1.07, 0.62, 0.68, 0.5, 1.0, 1.0]
2025-04-02 07:07:30,273 - INFO - Epoch 1/50 - Train Loss: 1.8117, Train Acc: 17.78% - Val Loss: 1.8024, Val Acc: 0.00%
2025-04-02 07:07:30,273 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,273 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,273 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,273 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:30,413 - INFO - Epoch 2/50 - Train Loss: 1.7993, Train Acc: 26.67% - Val Loss: 1.8067, Val Acc: 0.00%
2025-04-02 07:07:30,413 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,413 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,413 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,413 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:30,413 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:07:30,540 - INFO - Epoch 3/50 - Train Loss: 1.7882, Train Acc: 26.67% - Val Loss: 1.8077, Val Acc: 0.00%
2025-04-02 07:07:30,540 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,540 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,540 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,540 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:30,540 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:07:30,666 - INFO - Epoch 4/50 - Train Loss: 1.7892, Train Acc: 24.44% - Val Loss: 1.8067, Val Acc: 0.00%
2025-04-02 07:07:30,666 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,666 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,666 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,666 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:30,666 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:07:30,789 - INFO - Epoch 5/50 - Train Loss: 1.7825, Train Acc: 31.11% - Val Loss: 1.8032, Val Acc: 0.00%
2025-04-02 07:07:30,790 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,790 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,790 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,790 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:30,790 - INFO - EarlyStopping counter: 4/10
2025-04-02 07:07:30,791 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:07:30,936 - INFO - Epoch 6/50 - Train Loss: 1.7734, Train Acc: 31.11% - Val Loss: 1.7921, Val Acc: 0.00%
2025-04-02 07:07:30,936 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:30,936 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:30,936 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:30,936 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,078 - INFO - Epoch 7/50 - Train Loss: 1.7587, Train Acc: 26.67% - Val Loss: 1.7672, Val Acc: 0.00%
2025-04-02 07:07:31,078 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,078 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,078 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,078 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,204 - INFO - Epoch 8/50 - Train Loss: 1.7305, Train Acc: 48.89% - Val Loss: 1.7400, Val Acc: 0.00%
2025-04-02 07:07:31,204 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,204 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,204 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,204 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,337 - INFO - Epoch 9/50 - Train Loss: 1.7283, Train Acc: 28.89% - Val Loss: 1.7126, Val Acc: 0.00%
2025-04-02 07:07:31,338 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,338 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,338 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,338 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,473 - INFO - Epoch 10/50 - Train Loss: 1.7055, Train Acc: 28.89% - Val Loss: 1.6752, Val Acc: 0.00%
2025-04-02 07:07:31,473 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,473 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,473 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,473 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,475 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:07:31,616 - INFO - Epoch 11/50 - Train Loss: 1.6680, Train Acc: 33.33% - Val Loss: 1.6405, Val Acc: 0.00%
2025-04-02 07:07:31,616 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,616 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,616 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,616 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,758 - INFO - Epoch 12/50 - Train Loss: 1.6522, Train Acc: 24.44% - Val Loss: 1.5779, Val Acc: 0.00%
2025-04-02 07:07:31,758 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,759 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,759 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,759 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:31,894 - INFO - Epoch 13/50 - Train Loss: 1.6209, Train Acc: 20.00% - Val Loss: 1.5540, Val Acc: 0.00%
2025-04-02 07:07:31,895 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:31,895 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:31,895 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:31,895 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,017 - INFO - Epoch 14/50 - Train Loss: 1.5990, Train Acc: 31.11% - Val Loss: 1.5292, Val Acc: 0.00%
2025-04-02 07:07:32,018 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,018 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,018 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:32,018 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,169 - INFO - Epoch 15/50 - Train Loss: 1.5623, Train Acc: 31.11% - Val Loss: 1.5316, Val Acc: 16.67%
2025-04-02 07:07:32,169 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,169 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,169 - INFO -   combined: 66.67% (2/3)
2025-04-02 07:07:32,169 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,169 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:07:32,170 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:07:32,305 - INFO - Epoch 16/50 - Train Loss: 1.5205, Train Acc: 40.00% - Val Loss: 1.5414, Val Acc: 0.00%
2025-04-02 07:07:32,305 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,305 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,305 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:32,305 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,305 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:07:32,435 - INFO - Epoch 17/50 - Train Loss: 1.5606, Train Acc: 33.33% - Val Loss: 1.5352, Val Acc: 0.00%
2025-04-02 07:07:32,435 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,435 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,435 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:32,435 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,435 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:07:32,435 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:07:32,565 - INFO - Epoch 18/50 - Train Loss: 1.4860, Train Acc: 24.44% - Val Loss: 1.5118, Val Acc: 0.00%
2025-04-02 07:07:32,566 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,566 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,566 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:32,566 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,693 - INFO - Epoch 19/50 - Train Loss: 1.4962, Train Acc: 35.56% - Val Loss: 1.5055, Val Acc: 25.00%
2025-04-02 07:07:32,693 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,693 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,693 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:32,693 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,694 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch19.pth
2025-04-02 07:07:32,819 - INFO - Epoch 20/50 - Train Loss: 1.4538, Train Acc: 40.00% - Val Loss: 1.5083, Val Acc: 25.00%
2025-04-02 07:07:32,819 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,819 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,820 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:32,820 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:32,820 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:07:32,821 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 07:07:32,953 - INFO - Epoch 21/50 - Train Loss: 1.4815, Train Acc: 28.89% - Val Loss: 1.4976, Val Acc: 25.00%
2025-04-02 07:07:32,953 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:32,953 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:32,953 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:32,953 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,084 - INFO - Epoch 22/50 - Train Loss: 1.4662, Train Acc: 28.89% - Val Loss: 1.4888, Val Acc: 25.00%
2025-04-02 07:07:33,084 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,084 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:33,084 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:33,085 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,213 - INFO - Epoch 23/50 - Train Loss: 1.4214, Train Acc: 26.67% - Val Loss: 1.4478, Val Acc: 25.00%
2025-04-02 07:07:33,213 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,213 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:33,213 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:33,213 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,335 - INFO - Epoch 24/50 - Train Loss: 1.4560, Train Acc: 26.67% - Val Loss: 1.4186, Val Acc: 25.00%
2025-04-02 07:07:33,336 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,336 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:33,336 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:33,336 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,468 - INFO - Epoch 25/50 - Train Loss: 1.4168, Train Acc: 26.67% - Val Loss: 1.3642, Val Acc: 25.00%
2025-04-02 07:07:33,468 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,469 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:33,469 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:33,469 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,470 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-02 07:07:33,616 - INFO - Epoch 26/50 - Train Loss: 1.4231, Train Acc: 24.44% - Val Loss: 1.2357, Val Acc: 50.00%
2025-04-02 07:07:33,616 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,616 - INFO -   basic: 37.50% (3/8)
2025-04-02 07:07:33,616 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:33,616 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,618 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch26.pth
2025-04-02 07:07:33,743 - INFO - Epoch 27/50 - Train Loss: 1.4388, Train Acc: 17.78% - Val Loss: 1.2122, Val Acc: 58.33%
2025-04-02 07:07:33,743 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,743 - INFO -   basic: 75.00% (6/8)
2025-04-02 07:07:33,743 - INFO -   combined: 33.33% (1/3)
2025-04-02 07:07:33,743 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,745 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch27.pth
2025-04-02 07:07:33,891 - INFO - Epoch 28/50 - Train Loss: 1.3509, Train Acc: 35.56% - Val Loss: 1.1969, Val Acc: 66.67%
2025-04-02 07:07:33,891 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:33,891 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:33,891 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:33,891 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:33,893 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch28.pth
2025-04-02 07:07:34,018 - INFO - Epoch 29/50 - Train Loss: 1.4358, Train Acc: 15.56% - Val Loss: 1.1405, Val Acc: 66.67%
2025-04-02 07:07:34,018 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,018 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,018 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,018 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,152 - INFO - Epoch 30/50 - Train Loss: 1.3418, Train Acc: 31.11% - Val Loss: 1.1953, Val Acc: 66.67%
2025-04-02 07:07:34,152 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,152 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,152 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,152 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,152 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:07:34,154 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch30.pth
2025-04-02 07:07:34,283 - INFO - Epoch 31/50 - Train Loss: 1.3958, Train Acc: 24.44% - Val Loss: 1.2131, Val Acc: 66.67%
2025-04-02 07:07:34,284 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,284 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,284 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,284 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,284 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:07:34,422 - INFO - Epoch 32/50 - Train Loss: 1.3208, Train Acc: 31.11% - Val Loss: 1.1818, Val Acc: 66.67%
2025-04-02 07:07:34,422 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,422 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,422 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,422 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,422 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:07:34,422 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:07:34,559 - INFO - Epoch 33/50 - Train Loss: 1.3915, Train Acc: 17.78% - Val Loss: 1.1940, Val Acc: 66.67%
2025-04-02 07:07:34,559 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,559 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,559 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,559 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,560 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:07:34,729 - INFO - Epoch 34/50 - Train Loss: 1.3821, Train Acc: 22.22% - Val Loss: 1.1879, Val Acc: 66.67%
2025-04-02 07:07:34,729 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:34,729 - INFO -   basic: 100.00% (8/8)
2025-04-02 07:07:34,729 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:34,729 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:34,729 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:07:34,729 - INFO - Early Stopping in Epoche 34
2025-04-02 07:07:34,729 - INFO - Training abgeschlossen in 4.71 Sekunden
2025-04-02 07:07:34,730 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:07:34,731 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:07:34,731 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:07:34,793 - INFO - 
==================================================
2025-04-02 07:07:34,793 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:07:34,793 - INFO - ==================================================
2025-04-02 07:07:34,793 - INFO - Gesamtgenauigkeit: 66.67%
2025-04-02 07:07:34,793 - INFO - Makro-Präzision: 0.1111
2025-04-02 07:07:34,793 - INFO - Makro-Recall: 0.1667
2025-04-02 07:07:34,793 - INFO - Makro-F1: 0.1333
2025-04-02 07:07:34,793 - INFO - Mikro-F1 (Genauigkeit): 0.6667
2025-04-02 07:07:34,793 - INFO - 
Klassenweise Leistung:
2025-04-02 07:07:34,793 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:07:34,793 - INFO - ------------------------------------------------------------
2025-04-02 07:07:34,793 - INFO - basic           0.6667      1.0000      0.8000      8
2025-04-02 07:07:34,793 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:07:34,793 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-02 07:07:34,793 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 07:07:34,793 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:07:34,793 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:07:34,793 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:07:34,793 - INFO - 1. combined als basic klassifiziert: 3 Fälle
2025-04-02 07:07:34,793 - INFO - 2. mixed als basic klassifiziert: 1 Fälle
2025-04-02 07:07:34,793 - INFO - 
Konfusionsmatrix:
2025-04-02 07:07:34,793 - INFO -     8     0     0     0     0     0
    0     0     0     0     0     0
    3     0     0     0     0     0
    1     0     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:07:34,794 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:07:34,794 - INFO - Erstelle Visualisierungen...
2025-04-02 07:07:35,490 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:07:35,490 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:07:35,555 - INFO - Kalibrierung mit 36 repräsentativen Samples
2025-04-02 07:07:35,913 - WARNING - Quantisierung fehlgeschlagen: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 07:07:35,913 - WARNING - Verwende nicht-quantisiertes Modell für Export
2025-04-02 07:07:35,915 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:07:35,915 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1679, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 986, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:07:57,149 - INFO - ================================================================================
2025-04-02 07:07:57,149 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:07:57,149 - INFO - ================================================================================
2025-04-02 07:07:57,149 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:07:57,149 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:07:57,149 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:07:57,149 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:07:57,149 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:07:57,149 - INFO - ================================================================================
2025-04-02 07:07:57,149 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:07:57,184 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:07:57,184 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:07:57,184 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:07:57,184 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:07:57,184 - INFO - RGB-Mittelwerte: [0.4776, 0.3953, 0.3270]
2025-04-02 07:07:57,184 - INFO - RGB-Standardabweichungen: [0.2364, 0.2525, 0.2635]
2025-04-02 07:07:57,184 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:07:57,185 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47764213 0.39534682 0.32697782], std=[0.23636147 0.25254095 0.26354602]
2025-04-02 07:07:57,185 - INFO - Klassenverteilung (train):
2025-04-02 07:07:57,185 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:07:57,185 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:07:57,185 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:07:57,185 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:07:57,186 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:07:57,186 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:07:57,255 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:07:57,371 - INFO - Speicheranalyse:
2025-04-02 07:07:57,371 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:07:57,371 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:07:57,371 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:07:57,371 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:07:57,371 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:07:57,371 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:07:57,372 - INFO - Speicheranalyse:
2025-04-02 07:07:57,372 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:07:57,372 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:07:57,372 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:07:57,372 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:07:57,372 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:07:57,429 - INFO - Klassengewichte für Loss-Funktion: [1.07, 0.47, 1.07, 0.5, 1.0, 1.0]
2025-04-02 07:07:57,697 - INFO - Epoch 1/50 - Train Loss: 1.7992, Train Acc: 0.00% - Val Loss: 1.7922, Val Acc: 0.00%
2025-04-02 07:07:57,697 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:57,697 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:57,697 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:57,697 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:57,825 - INFO - Epoch 2/50 - Train Loss: 1.7987, Train Acc: 2.22% - Val Loss: 1.7914, Val Acc: 0.00%
2025-04-02 07:07:57,826 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:57,826 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:57,826 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:07:57,826 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:57,826 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:07:57,957 - INFO - Epoch 3/50 - Train Loss: 1.8003, Train Acc: 2.22% - Val Loss: 1.7845, Val Acc: 8.33%
2025-04-02 07:07:57,957 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:57,957 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:57,957 - INFO -   combined: 33.33% (1/3)
2025-04-02 07:07:57,957 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:57,959 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch3.pth
2025-04-02 07:07:58,114 - INFO - Epoch 4/50 - Train Loss: 1.7886, Train Acc: 8.89% - Val Loss: 1.7750, Val Acc: 25.00%
2025-04-02 07:07:58,114 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,114 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,114 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,114 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,115 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch4.pth
2025-04-02 07:07:58,247 - INFO - Epoch 5/50 - Train Loss: 1.7839, Train Acc: 31.11% - Val Loss: 1.7604, Val Acc: 25.00%
2025-04-02 07:07:58,247 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,247 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,247 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,247 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,248 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:07:58,375 - INFO - Epoch 6/50 - Train Loss: 1.7779, Train Acc: 26.67% - Val Loss: 1.7304, Val Acc: 25.00%
2025-04-02 07:07:58,375 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,375 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,375 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,375 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,506 - INFO - Epoch 7/50 - Train Loss: 1.7660, Train Acc: 24.44% - Val Loss: 1.6945, Val Acc: 25.00%
2025-04-02 07:07:58,506 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,506 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,506 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,506 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,646 - INFO - Epoch 8/50 - Train Loss: 1.7379, Train Acc: 26.67% - Val Loss: 1.6366, Val Acc: 25.00%
2025-04-02 07:07:58,646 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,646 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,646 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,646 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,780 - INFO - Epoch 9/50 - Train Loss: 1.7225, Train Acc: 22.22% - Val Loss: 1.5625, Val Acc: 25.00%
2025-04-02 07:07:58,781 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,781 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,781 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,781 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,911 - INFO - Epoch 10/50 - Train Loss: 1.6933, Train Acc: 22.22% - Val Loss: 1.4862, Val Acc: 25.00%
2025-04-02 07:07:58,911 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:58,911 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:58,911 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:58,911 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:58,913 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:07:59,057 - INFO - Epoch 11/50 - Train Loss: 1.6743, Train Acc: 24.44% - Val Loss: 1.4036, Val Acc: 25.00%
2025-04-02 07:07:59,057 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,057 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,057 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,057 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,187 - INFO - Epoch 12/50 - Train Loss: 1.6222, Train Acc: 33.33% - Val Loss: 1.3762, Val Acc: 25.00%
2025-04-02 07:07:59,187 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,187 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,187 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,187 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,325 - INFO - Epoch 13/50 - Train Loss: 1.5756, Train Acc: 26.67% - Val Loss: 1.3082, Val Acc: 25.00%
2025-04-02 07:07:59,325 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,325 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,325 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,325 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,471 - INFO - Epoch 14/50 - Train Loss: 1.5374, Train Acc: 24.44% - Val Loss: 1.2393, Val Acc: 25.00%
2025-04-02 07:07:59,471 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,471 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,471 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,471 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,612 - INFO - Epoch 15/50 - Train Loss: 1.5171, Train Acc: 17.78% - Val Loss: 1.1856, Val Acc: 25.00%
2025-04-02 07:07:59,612 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,612 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,612 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,612 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,613 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:07:59,748 - INFO - Epoch 16/50 - Train Loss: 1.5050, Train Acc: 22.22% - Val Loss: 1.1429, Val Acc: 25.00%
2025-04-02 07:07:59,748 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,748 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,748 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,748 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:07:59,881 - INFO - Epoch 17/50 - Train Loss: 1.4991, Train Acc: 24.44% - Val Loss: 1.0848, Val Acc: 25.00%
2025-04-02 07:07:59,881 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:07:59,881 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:07:59,881 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:07:59,881 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,019 - INFO - Epoch 18/50 - Train Loss: 1.4381, Train Acc: 22.22% - Val Loss: 1.1187, Val Acc: 25.00%
2025-04-02 07:08:00,019 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:08:00,019 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:08:00,019 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:08:00,019 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,019 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:08:00,148 - INFO - Epoch 19/50 - Train Loss: 1.4575, Train Acc: 28.89% - Val Loss: 1.1085, Val Acc: 25.00%
2025-04-02 07:08:00,148 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:08:00,148 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:08:00,148 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:08:00,148 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,148 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:08:00,283 - INFO - Epoch 20/50 - Train Loss: 1.3630, Train Acc: 28.89% - Val Loss: 1.1511, Val Acc: 25.00%
2025-04-02 07:08:00,283 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:08:00,283 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:08:00,283 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:08:00,283 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,283 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:08:00,283 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:08:00,284 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 07:08:00,427 - INFO - Epoch 21/50 - Train Loss: 1.3723, Train Acc: 24.44% - Val Loss: 1.1822, Val Acc: 25.00%
2025-04-02 07:08:00,427 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:08:00,427 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:08:00,427 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:08:00,427 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,428 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:08:00,561 - INFO - Epoch 22/50 - Train Loss: 1.4948, Train Acc: 17.78% - Val Loss: 1.2080, Val Acc: 25.00%
2025-04-02 07:08:00,561 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:08:00,562 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:08:00,562 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:08:00,562 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:08:00,562 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:08:00,562 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:08:00,562 - INFO - Early Stopping in Epoche 22
2025-04-02 07:08:00,562 - INFO - Training abgeschlossen in 3.13 Sekunden
2025-04-02 07:08:00,562 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:08:00,563 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:08:00,563 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:08:00,628 - INFO - 
==================================================
2025-04-02 07:08:00,628 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:08:00,628 - INFO - ==================================================
2025-04-02 07:08:00,628 - INFO - Gesamtgenauigkeit: 25.00%
2025-04-02 07:08:00,628 - INFO - Makro-Präzision: 0.0417
2025-04-02 07:08:00,628 - INFO - Makro-Recall: 0.1667
2025-04-02 07:08:00,628 - INFO - Makro-F1: 0.0667
2025-04-02 07:08:00,628 - INFO - Mikro-F1 (Genauigkeit): 0.2500
2025-04-02 07:08:00,628 - INFO - 
Klassenweise Leistung:
2025-04-02 07:08:00,628 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:08:00,628 - INFO - ------------------------------------------------------------
2025-04-02 07:08:00,628 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 07:08:00,628 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:08:00,628 - INFO - combined        0.2500      1.0000      0.4000      3
2025-04-02 07:08:00,628 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 07:08:00,628 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:08:00,628 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:08:00,628 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:08:00,628 - INFO - 1. basic als combined klassifiziert: 8 Fälle
2025-04-02 07:08:00,628 - INFO - 2. mixed als combined klassifiziert: 1 Fälle
2025-04-02 07:08:00,628 - INFO - 
Konfusionsmatrix:
2025-04-02 07:08:00,628 - INFO -     0     0     8     0     0     0
    0     0     0     0     0     0
    0     0     3     0     0     0
    0     0     1     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:08:00,628 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:08:00,628 - INFO - Erstelle Visualisierungen...
2025-04-02 07:08:01,379 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:08:01,379 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:08:01,449 - INFO - Kalibrierung mit 37 repräsentativen Samples
2025-04-02 07:08:01,811 - WARNING - Quantisierung fehlgeschlagen: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 07:08:01,811 - WARNING - Verwende nicht-quantisiertes Modell für Export
2025-04-02 07:08:01,812 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:08:01,812 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1679, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 986, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:11:40,534 - INFO - ================================================================================
2025-04-02 07:11:40,534 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:11:40,534 - INFO - ================================================================================
2025-04-02 07:11:40,534 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:11:40,534 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:11:40,534 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:11:40,534 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:11:40,535 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:11:40,535 - INFO - ================================================================================
2025-04-02 07:11:40,535 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:11:40,579 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:11:40,579 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:11:40,579 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:11:40,579 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:11:40,579 - INFO - RGB-Mittelwerte: [0.4716, 0.3897, 0.3230]
2025-04-02 07:11:40,579 - INFO - RGB-Standardabweichungen: [0.2279, 0.2472, 0.2619]
2025-04-02 07:11:40,579 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:11:40,579 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47161299 0.3896896  0.32295398], std=[0.22788586 0.2471661  0.26187893]
2025-04-02 07:11:40,580 - INFO - Klassenverteilung (train):
2025-04-02 07:11:40,580 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:11:40,580 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:11:40,580 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:11:40,580 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:11:40,580 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:11:40,580 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:11:40,640 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:11:40,754 - INFO - Speicheranalyse:
2025-04-02 07:11:40,754 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:11:40,754 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:11:40,754 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:11:40,754 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:11:40,754 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:11:40,754 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:11:40,755 - INFO - Speicheranalyse:
2025-04-02 07:11:40,755 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:11:40,755 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:11:40,755 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:11:40,755 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:11:40,755 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:11:40,818 - INFO - Klassengewichte für Loss-Funktion: [0.58, 0.75, 1.07, 0.5, 1.0, 1.0]
2025-04-02 07:11:41,084 - INFO - Epoch 1/50 - Train Loss: 1.7985, Train Acc: 13.33% - Val Loss: 1.7954, Val Acc: 0.00%
2025-04-02 07:11:41,085 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,085 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,085 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:11:41,085 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:41,227 - INFO - Epoch 2/50 - Train Loss: 1.7875, Train Acc: 35.56% - Val Loss: 1.7942, Val Acc: 25.00%
2025-04-02 07:11:41,227 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,227 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,227 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,227 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:41,229 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch2.pth
2025-04-02 07:11:41,366 - INFO - Epoch 3/50 - Train Loss: 1.7904, Train Acc: 11.11% - Val Loss: 1.7938, Val Acc: 33.33%
2025-04-02 07:11:41,366 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,366 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,366 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,366 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:11:41,366 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:11:41,367 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch3.pth
2025-04-02 07:11:41,505 - INFO - Epoch 4/50 - Train Loss: 1.7818, Train Acc: 31.11% - Val Loss: 1.7915, Val Acc: 25.00%
2025-04-02 07:11:41,506 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,506 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,506 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,506 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:41,668 - INFO - Epoch 5/50 - Train Loss: 1.7691, Train Acc: 22.22% - Val Loss: 1.7906, Val Acc: 25.00%
2025-04-02 07:11:41,668 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,668 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,668 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,668 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:41,668 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:11:41,670 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:11:41,826 - INFO - Epoch 6/50 - Train Loss: 1.7530, Train Acc: 26.67% - Val Loss: 1.7839, Val Acc: 25.00%
2025-04-02 07:11:41,826 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,826 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,826 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,826 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:41,964 - INFO - Epoch 7/50 - Train Loss: 1.7407, Train Acc: 31.11% - Val Loss: 1.7719, Val Acc: 25.00%
2025-04-02 07:11:41,964 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:41,964 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:41,964 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:41,964 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,100 - INFO - Epoch 8/50 - Train Loss: 1.7272, Train Acc: 31.11% - Val Loss: 1.7520, Val Acc: 25.00%
2025-04-02 07:11:42,100 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,100 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,100 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,100 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,232 - INFO - Epoch 9/50 - Train Loss: 1.6922, Train Acc: 20.00% - Val Loss: 1.7303, Val Acc: 25.00%
2025-04-02 07:11:42,232 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,232 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,232 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,232 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,372 - INFO - Epoch 10/50 - Train Loss: 1.6786, Train Acc: 26.67% - Val Loss: 1.7119, Val Acc: 25.00%
2025-04-02 07:11:42,372 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,372 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,372 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,372 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,373 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:11:42,515 - INFO - Epoch 11/50 - Train Loss: 1.6431, Train Acc: 26.67% - Val Loss: 1.6789, Val Acc: 25.00%
2025-04-02 07:11:42,515 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,515 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,515 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,515 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,657 - INFO - Epoch 12/50 - Train Loss: 1.6328, Train Acc: 22.22% - Val Loss: 1.6366, Val Acc: 25.00%
2025-04-02 07:11:42,657 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,657 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,657 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,657 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,795 - INFO - Epoch 13/50 - Train Loss: 1.5531, Train Acc: 31.11% - Val Loss: 1.5887, Val Acc: 25.00%
2025-04-02 07:11:42,795 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,795 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,795 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,795 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:42,928 - INFO - Epoch 14/50 - Train Loss: 1.5561, Train Acc: 28.89% - Val Loss: 1.5170, Val Acc: 25.00%
2025-04-02 07:11:42,928 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:42,928 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:42,928 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:42,928 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,065 - INFO - Epoch 15/50 - Train Loss: 1.5035, Train Acc: 22.22% - Val Loss: 1.5368, Val Acc: 25.00%
2025-04-02 07:11:43,065 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:43,065 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:43,065 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:43,065 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,065 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:11:43,066 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:11:43,206 - INFO - Epoch 16/50 - Train Loss: 1.5263, Train Acc: 20.00% - Val Loss: 1.5566, Val Acc: 25.00%
2025-04-02 07:11:43,206 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:43,206 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:43,206 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:43,206 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,207 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:11:43,353 - INFO - Epoch 17/50 - Train Loss: 1.4749, Train Acc: 24.44% - Val Loss: 1.5602, Val Acc: 25.00%
2025-04-02 07:11:43,353 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:43,353 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:43,353 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:43,353 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,353 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:11:43,353 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:11:43,483 - INFO - Epoch 18/50 - Train Loss: 1.4429, Train Acc: 26.67% - Val Loss: 1.5414, Val Acc: 25.00%
2025-04-02 07:11:43,484 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:43,484 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:43,484 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:43,484 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,484 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:11:43,484 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:11:43,618 - INFO - Epoch 19/50 - Train Loss: 1.4379, Train Acc: 22.22% - Val Loss: 1.5422, Val Acc: 25.00%
2025-04-02 07:11:43,618 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:11:43,618 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:11:43,618 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:11:43,618 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:11:43,618 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:11:43,618 - INFO - Early Stopping in Epoche 19
2025-04-02 07:11:43,618 - INFO - Training abgeschlossen in 2.80 Sekunden
2025-04-02 07:11:43,619 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:11:43,620 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:11:43,620 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:11:43,683 - INFO - 
==================================================
2025-04-02 07:11:43,683 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:11:43,683 - INFO - ==================================================
2025-04-02 07:11:43,683 - INFO - Gesamtgenauigkeit: 25.00%
2025-04-02 07:11:43,683 - INFO - Makro-Präzision: 0.0417
2025-04-02 07:11:43,683 - INFO - Makro-Recall: 0.1667
2025-04-02 07:11:43,683 - INFO - Makro-F1: 0.0667
2025-04-02 07:11:43,683 - INFO - Mikro-F1 (Genauigkeit): 0.2500
2025-04-02 07:11:43,683 - INFO - 
Klassenweise Leistung:
2025-04-02 07:11:43,683 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:11:43,683 - INFO - ------------------------------------------------------------
2025-04-02 07:11:43,683 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 07:11:43,683 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:11:43,684 - INFO - combined        0.2500      1.0000      0.4000      3
2025-04-02 07:11:43,684 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 07:11:43,684 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:11:43,684 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:11:43,684 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:11:43,684 - INFO - 1. basic als combined klassifiziert: 8 Fälle
2025-04-02 07:11:43,684 - INFO - 2. mixed als combined klassifiziert: 1 Fälle
2025-04-02 07:11:43,684 - INFO - 
Konfusionsmatrix:
2025-04-02 07:11:43,684 - INFO -     0     0     8     0     0     0
    0     0     0     0     0     0
    0     0     3     0     0     0
    0     0     1     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:11:43,684 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:11:43,684 - INFO - Erstelle Visualisierungen...
2025-04-02 07:11:44,387 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:11:44,387 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:11:44,460 - INFO - Kalibrierung mit 37 repräsentativen Samples
2025-04-02 07:11:44,806 - WARNING - Quantisierung fehlgeschlagen: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 07:11:44,806 - WARNING - Verwende nicht-quantisiertes Modell für Export
2025-04-02 07:11:44,808 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:11:44,808 - ERROR - Fehler im Optimierungsprozess: 'mean'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1679, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 986, in export_to_microcontroller
    f.write(", ".join(["{:.6f}f".format(x) for x in preprocess_params['mean']]))
                                                    ~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'mean'
2025-04-02 07:16:28,310 - INFO - ================================================================================
2025-04-02 07:16:28,310 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-02 07:16:28,310 - INFO - ================================================================================
2025-04-02 07:16:28,310 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-02 07:16:28,310 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-02 07:16:28,310 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-02 07:16:28,311 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-02 07:16:28,311 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-02 07:16:28,311 - INFO - ================================================================================
2025-04-02 07:16:28,311 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-02 07:16:28,345 - INFO - Datensatzanalyse abgeschlossen:
2025-04-02 07:16:28,345 - INFO - Gesamtzahl der Bilder: 57
2025-04-02 07:16:28,345 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-02 07:16:28,345 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-02 07:16:28,345 - INFO - RGB-Mittelwerte: [0.4794, 0.3957, 0.3242]
2025-04-02 07:16:28,345 - INFO - RGB-Standardabweichungen: [0.2348, 0.2518, 0.2639]
2025-04-02 07:16:28,345 - INFO - Bereite optimierte Datenlader vor...
2025-04-02 07:16:28,345 - INFO - Verwende dataset-spezifische Normalisierung: mean=[0.47935871 0.39572979 0.32422196], std=[0.23475593 0.25177728 0.26392367]
2025-04-02 07:16:28,346 - INFO - Klassenverteilung (train):
2025-04-02 07:16:28,346 - INFO -   basic: 29 Bilder, Gewicht=0.33
2025-04-02 07:16:28,346 - INFO -   burnt: 4 Bilder, Gewicht=2.38
2025-04-02 07:16:28,346 - INFO -   combined: 17 Bilder, Gewicht=0.56
2025-04-02 07:16:28,346 - INFO -   mixed: 7 Bilder, Gewicht=1.36
2025-04-02 07:16:28,346 - INFO - Datenlader erstellt: 45 Trainingsbilder, 12 Validierungsbilder
2025-04-02 07:16:28,346 - INFO - Klassen: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-02 07:16:28,445 - INFO - Modell erstellt mit 582 Parametern
2025-04-02 07:16:28,561 - INFO - Speicheranalyse:
2025-04-02 07:16:28,561 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:16:28,561 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:16:28,562 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:16:28,562 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:16:28,562 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:16:28,562 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-02 07:16:28,562 - INFO - Speicheranalyse:
2025-04-02 07:16:28,562 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-02 07:16:28,562 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-02 07:16:28,562 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-02 07:16:28,563 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-02 07:16:28,563 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-02 07:16:28,627 - INFO - Klassengewichte für Loss-Funktion: [1.07, 0.44, 0.94, 0.58, 1.0, 1.0]
2025-04-02 07:16:28,909 - INFO - Epoch 1/50 - Train Loss: 1.7949, Train Acc: 11.11% - Val Loss: 1.7999, Val Acc: 8.33%
2025-04-02 07:16:28,909 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:28,909 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:28,909 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:16:28,909 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:28,911 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-02 07:16:29,066 - INFO - Epoch 2/50 - Train Loss: 1.7852, Train Acc: 26.67% - Val Loss: 1.7991, Val Acc: 8.33%
2025-04-02 07:16:29,066 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,066 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,066 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:16:29,066 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:29,066 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:16:29,210 - INFO - Epoch 3/50 - Train Loss: 1.7915, Train Acc: 15.56% - Val Loss: 1.7951, Val Acc: 8.33%
2025-04-02 07:16:29,210 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,210 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,210 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:16:29,210 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:29,370 - INFO - Epoch 4/50 - Train Loss: 1.7815, Train Acc: 17.78% - Val Loss: 1.7904, Val Acc: 8.33%
2025-04-02 07:16:29,370 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,370 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,370 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:16:29,370 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:29,512 - INFO - Epoch 5/50 - Train Loss: 1.7809, Train Acc: 17.78% - Val Loss: 1.7776, Val Acc: 8.33%
2025-04-02 07:16:29,512 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,512 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,512 - INFO -   combined: 0.00% (0/3)
2025-04-02 07:16:29,512 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:29,514 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-02 07:16:29,655 - INFO - Epoch 6/50 - Train Loss: 1.7717, Train Acc: 15.56% - Val Loss: 1.7631, Val Acc: 16.67%
2025-04-02 07:16:29,655 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,655 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,655 - INFO -   combined: 33.33% (1/3)
2025-04-02 07:16:29,655 - INFO -   mixed: 100.00% (1/1)
2025-04-02 07:16:29,657 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch6.pth
2025-04-02 07:16:29,790 - INFO - Epoch 7/50 - Train Loss: 1.7522, Train Acc: 26.67% - Val Loss: 1.7388, Val Acc: 25.00%
2025-04-02 07:16:29,790 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,790 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,790 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:29,790 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:29,791 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch7.pth
2025-04-02 07:16:29,943 - INFO - Epoch 8/50 - Train Loss: 1.7388, Train Acc: 22.22% - Val Loss: 1.7048, Val Acc: 25.00%
2025-04-02 07:16:29,943 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:29,943 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:29,943 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:29,943 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,077 - INFO - Epoch 9/50 - Train Loss: 1.7121, Train Acc: 17.78% - Val Loss: 1.6573, Val Acc: 25.00%
2025-04-02 07:16:30,077 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,077 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,077 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,077 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,217 - INFO - Epoch 10/50 - Train Loss: 1.7002, Train Acc: 15.56% - Val Loss: 1.5935, Val Acc: 25.00%
2025-04-02 07:16:30,217 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,217 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,217 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,217 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,218 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-02 07:16:30,374 - INFO - Epoch 11/50 - Train Loss: 1.6637, Train Acc: 24.44% - Val Loss: 1.5288, Val Acc: 25.00%
2025-04-02 07:16:30,374 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,374 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,374 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,375 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,525 - INFO - Epoch 12/50 - Train Loss: 1.6326, Train Acc: 24.44% - Val Loss: 1.4507, Val Acc: 25.00%
2025-04-02 07:16:30,525 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,525 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,525 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,525 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,665 - INFO - Epoch 13/50 - Train Loss: 1.6072, Train Acc: 28.89% - Val Loss: 1.3699, Val Acc: 25.00%
2025-04-02 07:16:30,665 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,665 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,665 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,665 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,804 - INFO - Epoch 14/50 - Train Loss: 1.6026, Train Acc: 28.89% - Val Loss: 1.3395, Val Acc: 25.00%
2025-04-02 07:16:30,804 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,804 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,804 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,804 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,962 - INFO - Epoch 15/50 - Train Loss: 1.5287, Train Acc: 35.56% - Val Loss: 1.3369, Val Acc: 25.00%
2025-04-02 07:16:30,962 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:30,962 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:30,962 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:30,962 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:30,963 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-02 07:16:31,107 - INFO - Epoch 16/50 - Train Loss: 1.4952, Train Acc: 20.00% - Val Loss: 1.2920, Val Acc: 25.00%
2025-04-02 07:16:31,107 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,107 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,107 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,107 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,254 - INFO - Epoch 17/50 - Train Loss: 1.4783, Train Acc: 22.22% - Val Loss: 1.2605, Val Acc: 25.00%
2025-04-02 07:16:31,255 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,255 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,255 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,255 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,394 - INFO - Epoch 18/50 - Train Loss: 1.4710, Train Acc: 24.44% - Val Loss: 1.2643, Val Acc: 25.00%
2025-04-02 07:16:31,394 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,394 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,394 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,394 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,394 - INFO - EarlyStopping counter: 1/10
2025-04-02 07:16:31,535 - INFO - Epoch 19/50 - Train Loss: 1.4277, Train Acc: 28.89% - Val Loss: 1.2904, Val Acc: 25.00%
2025-04-02 07:16:31,535 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,535 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,535 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,535 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,535 - INFO - EarlyStopping counter: 2/10
2025-04-02 07:16:31,682 - INFO - Epoch 20/50 - Train Loss: 1.5002, Train Acc: 24.44% - Val Loss: 1.3237, Val Acc: 25.00%
2025-04-02 07:16:31,682 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,682 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,682 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,682 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,682 - INFO - EarlyStopping counter: 3/10
2025-04-02 07:16:31,682 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:16:31,683 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-02 07:16:31,830 - INFO - Epoch 21/50 - Train Loss: 1.3503, Train Acc: 33.33% - Val Loss: 1.4010, Val Acc: 25.00%
2025-04-02 07:16:31,830 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,830 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,830 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,830 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,830 - INFO - EarlyStopping counter: 9/10
2025-04-02 07:16:31,830 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:16:31,969 - INFO - Epoch 22/50 - Train Loss: 1.3543, Train Acc: 33.33% - Val Loss: 1.5547, Val Acc: 25.00%
2025-04-02 07:16:31,969 - INFO - Klassenweise Genauigkeiten:
2025-04-02 07:16:31,969 - INFO -   basic: 0.00% (0/8)
2025-04-02 07:16:31,969 - INFO -   combined: 100.00% (3/3)
2025-04-02 07:16:31,969 - INFO -   mixed: 0.00% (0/1)
2025-04-02 07:16:31,969 - INFO - EarlyStopping counter: 10/10
2025-04-02 07:16:31,969 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-02 07:16:31,969 - INFO - Early Stopping in Epoche 22
2025-04-02 07:16:31,969 - INFO - Training abgeschlossen in 3.34 Sekunden
2025-04-02 07:16:31,970 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-02 07:16:31,971 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-02 07:16:31,971 - INFO - Starte detaillierte Modellevaluierung...
2025-04-02 07:16:32,036 - INFO - 
==================================================
2025-04-02 07:16:32,037 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-02 07:16:32,037 - INFO - ==================================================
2025-04-02 07:16:32,037 - INFO - Gesamtgenauigkeit: 25.00%
2025-04-02 07:16:32,037 - INFO - Makro-Präzision: 0.0417
2025-04-02 07:16:32,037 - INFO - Makro-Recall: 0.1667
2025-04-02 07:16:32,037 - INFO - Makro-F1: 0.0667
2025-04-02 07:16:32,037 - INFO - Mikro-F1 (Genauigkeit): 0.2500
2025-04-02 07:16:32,037 - INFO - 
Klassenweise Leistung:
2025-04-02 07:16:32,037 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-02 07:16:32,037 - INFO - ------------------------------------------------------------
2025-04-02 07:16:32,037 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-02 07:16:32,037 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-02 07:16:32,037 - INFO - combined        0.2500      1.0000      0.4000      3
2025-04-02 07:16:32,037 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-02 07:16:32,037 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-02 07:16:32,037 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-02 07:16:32,037 - INFO - 
Top-5 häufigste Fehler:
2025-04-02 07:16:32,037 - INFO - 1. basic als combined klassifiziert: 8 Fälle
2025-04-02 07:16:32,037 - INFO - 2. mixed als combined klassifiziert: 1 Fälle
2025-04-02 07:16:32,037 - INFO - 
Konfusionsmatrix:
2025-04-02 07:16:32,037 - INFO -     0     0     8     0     0     0
    0     0     0     0     0     0
    0     0     3     0     0     0
    0     0     1     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-02 07:16:32,037 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-02 07:16:32,037 - INFO - Erstelle Visualisierungen...
2025-04-02 07:16:32,725 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-02 07:16:32,725 - INFO - Starte Kalibrierung und Quantisierung des Modells...
2025-04-02 07:16:32,799 - INFO - Kalibrierung mit 36 repräsentativen Samples
2025-04-02 07:16:33,143 - WARNING - Quantisierung fehlgeschlagen: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-02 07:16:33,143 - WARNING - Verwende nicht-quantisiertes Modell für Export
2025-04-02 07:16:33,145 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-02 07:16:33,145 - INFO - Mikrocontroller-Export abgeschlossen: models_optimized/rp2040_export
2025-04-02 07:16:33,145 - INFO - 
================================================================================
2025-04-02 07:16:33,145 - INFO - ZUSAMMENFASSUNG DES OPTIMIERUNGSPROZESSES
2025-04-02 07:16:33,146 - INFO - ================================================================================
2025-04-02 07:16:33,146 - INFO - Gesamtzeit: 0.08 Minuten
2025-04-02 07:16:33,146 - INFO - Modellgröße: 0.63 KB (quantisiert)
2025-04-02 07:16:33,146 - INFO - Genauigkeit: 25.00%
2025-04-02 07:16:33,146 - INFO - Makro-F1-Score: 0.0667
2025-04-02 07:16:33,146 - INFO - Export-Verzeichnis: models_optimized/rp2040_export
2025-04-02 07:16:33,146 - INFO - ================================================================================
2025-04-02 07:16:33,146 - INFO - Abschließende README erstellt: models_optimized/README.md
2025-04-04 08:31:31,119 - INFO - ================================================================================
2025-04-04 08:31:31,120 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-04 08:31:31,120 - INFO - ================================================================================
2025-04-04 08:31:31,120 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-04 08:31:31,120 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-04 08:31:31,120 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-04 08:31:31,120 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-04 08:31:31,120 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-04 08:31:31,120 - INFO - ================================================================================
2025-04-04 08:31:31,120 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-04 08:31:31,168 - INFO - Datensatzanalyse abgeschlossen:
2025-04-04 08:31:31,168 - INFO - Gesamtzahl der Bilder: 57
2025-04-04 08:31:31,168 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-04 08:31:31,168 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-04 08:31:31,168 - INFO - RGB-Mittelwerte: [0.4714, 0.3898, 0.3281]
2025-04-04 08:31:31,168 - INFO - RGB-Standardabweichungen: [0.2238, 0.2433, 0.2622]
2025-04-04 08:31:31,168 - INFO - Preparing optimized data loaders...
2025-04-04 08:31:31,168 - INFO - Using dataset-specific normalization: mean=[0.47138199 0.38981126 0.32810733], std=[0.22379113 0.24334509 0.2622424 ]
2025-04-04 08:31:31,170 - INFO - Data loaders created: 45 training images, 12 validation images
2025-04-04 08:31:31,170 - INFO - Classes: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-04 08:31:31,240 - INFO - Modell erstellt mit 582 Parametern
2025-04-04 08:31:31,653 - INFO - Speicheranalyse:
2025-04-04 08:31:31,653 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 08:31:31,653 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 08:31:31,653 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 08:31:31,653 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 08:31:31,653 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 08:31:31,653 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-04 08:31:31,654 - INFO - Speicheranalyse:
2025-04-04 08:31:31,654 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 08:31:31,654 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 08:31:31,654 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 08:31:31,654 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 08:31:31,654 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 08:31:31,704 - INFO - Klassengewichte für Loss-Funktion: [0.68, 0.58, 0.94, 0.58, 1.0, 1.0]
2025-04-04 08:31:32,232 - INFO - Epoch 1/50 - Train Loss: 1.7951, Train Acc: 15.56% - Val Loss: 1.7916, Val Acc: 0.00%
2025-04-04 08:31:32,232 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,232 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,232 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,232 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,336 - INFO - Epoch 2/50 - Train Loss: 1.7980, Train Acc: 22.22% - Val Loss: 1.7922, Val Acc: 0.00%
2025-04-04 08:31:32,336 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,336 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,336 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,336 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,336 - INFO - EarlyStopping counter: 1/10
2025-04-04 08:31:32,451 - INFO - Epoch 3/50 - Train Loss: 1.7897, Train Acc: 20.00% - Val Loss: 1.7918, Val Acc: 0.00%
2025-04-04 08:31:32,451 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,451 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,451 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,451 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,451 - INFO - EarlyStopping counter: 2/10
2025-04-04 08:31:32,569 - INFO - Epoch 4/50 - Train Loss: 1.7864, Train Acc: 24.44% - Val Loss: 1.7904, Val Acc: 0.00%
2025-04-04 08:31:32,569 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,569 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,569 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,569 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,676 - INFO - Epoch 5/50 - Train Loss: 1.7724, Train Acc: 35.56% - Val Loss: 1.7876, Val Acc: 0.00%
2025-04-04 08:31:32,677 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,677 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,677 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,677 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,679 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-04 08:31:32,788 - INFO - Epoch 6/50 - Train Loss: 1.7670, Train Acc: 28.89% - Val Loss: 1.7832, Val Acc: 0.00%
2025-04-04 08:31:32,788 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,788 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,788 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,788 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:32,895 - INFO - Epoch 7/50 - Train Loss: 1.7450, Train Acc: 31.11% - Val Loss: 1.7767, Val Acc: 0.00%
2025-04-04 08:31:32,895 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:32,895 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:32,895 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:32,895 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,000 - INFO - Epoch 8/50 - Train Loss: 1.7353, Train Acc: 31.11% - Val Loss: 1.7680, Val Acc: 0.00%
2025-04-04 08:31:33,000 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,000 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,000 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:33,000 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,105 - INFO - Epoch 9/50 - Train Loss: 1.7070, Train Acc: 35.56% - Val Loss: 1.7557, Val Acc: 0.00%
2025-04-04 08:31:33,106 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,106 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,106 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:33,106 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,213 - INFO - Epoch 10/50 - Train Loss: 1.7061, Train Acc: 22.22% - Val Loss: 1.7339, Val Acc: 0.00%
2025-04-04 08:31:33,214 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,214 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,214 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:33,214 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,215 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-04 08:31:33,353 - INFO - Epoch 11/50 - Train Loss: 1.6646, Train Acc: 31.11% - Val Loss: 1.7063, Val Acc: 0.00%
2025-04-04 08:31:33,353 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,353 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,353 - INFO -   combined: 0.00% (0/3)
2025-04-04 08:31:33,353 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,457 - INFO - Epoch 12/50 - Train Loss: 1.6485, Train Acc: 13.33% - Val Loss: 1.6749, Val Acc: 25.00%
2025-04-04 08:31:33,457 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,457 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,457 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,457 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,459 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch12.pth
2025-04-04 08:31:33,569 - INFO - Epoch 13/50 - Train Loss: 1.6085, Train Acc: 22.22% - Val Loss: 1.6362, Val Acc: 25.00%
2025-04-04 08:31:33,569 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,569 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,570 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,570 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,683 - INFO - Epoch 14/50 - Train Loss: 1.5907, Train Acc: 17.78% - Val Loss: 1.5971, Val Acc: 25.00%
2025-04-04 08:31:33,683 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,683 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,683 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,683 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,788 - INFO - Epoch 15/50 - Train Loss: 1.5364, Train Acc: 22.22% - Val Loss: 1.5632, Val Acc: 25.00%
2025-04-04 08:31:33,788 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,788 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,788 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,788 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,790 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-04 08:31:33,896 - INFO - Epoch 16/50 - Train Loss: 1.5193, Train Acc: 24.44% - Val Loss: 1.5510, Val Acc: 25.00%
2025-04-04 08:31:33,896 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,896 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,896 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,896 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,999 - INFO - Epoch 17/50 - Train Loss: 1.4658, Train Acc: 31.11% - Val Loss: 1.5635, Val Acc: 25.00%
2025-04-04 08:31:33,999 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:33,999 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:33,999 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:33,999 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:33,999 - INFO - EarlyStopping counter: 1/10
2025-04-04 08:31:34,107 - INFO - Epoch 18/50 - Train Loss: 1.5132, Train Acc: 20.00% - Val Loss: 1.5661, Val Acc: 25.00%
2025-04-04 08:31:34,107 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,107 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,107 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,107 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,107 - INFO - EarlyStopping counter: 2/10
2025-04-04 08:31:34,212 - INFO - Epoch 19/50 - Train Loss: 1.4394, Train Acc: 24.44% - Val Loss: 1.5725, Val Acc: 25.00%
2025-04-04 08:31:34,212 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,212 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,212 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,212 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,212 - INFO - EarlyStopping counter: 3/10
2025-04-04 08:31:34,212 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 08:31:34,319 - INFO - Epoch 20/50 - Train Loss: 1.4982, Train Acc: 24.44% - Val Loss: 1.5511, Val Acc: 25.00%
2025-04-04 08:31:34,319 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,319 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,319 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,319 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,320 - INFO - EarlyStopping counter: 9/10
2025-04-04 08:31:34,321 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-04 08:31:34,432 - INFO - Epoch 21/50 - Train Loss: 1.4024, Train Acc: 28.89% - Val Loss: 1.5319, Val Acc: 25.00%
2025-04-04 08:31:34,432 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,432 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,432 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,432 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,540 - INFO - Epoch 22/50 - Train Loss: 1.4834, Train Acc: 17.78% - Val Loss: 1.5257, Val Acc: 25.00%
2025-04-04 08:31:34,540 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,540 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,540 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,540 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,647 - INFO - Epoch 23/50 - Train Loss: 1.4155, Train Acc: 20.00% - Val Loss: 1.5167, Val Acc: 25.00%
2025-04-04 08:31:34,648 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,648 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,648 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,648 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,757 - INFO - Epoch 24/50 - Train Loss: 1.4162, Train Acc: 24.44% - Val Loss: 1.5057, Val Acc: 25.00%
2025-04-04 08:31:34,757 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,757 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,757 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,757 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,873 - INFO - Epoch 25/50 - Train Loss: 1.4105, Train Acc: 22.22% - Val Loss: 1.4823, Val Acc: 25.00%
2025-04-04 08:31:34,873 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,873 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,874 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,874 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:34,877 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-04 08:31:34,995 - INFO - Epoch 26/50 - Train Loss: 1.3592, Train Acc: 33.33% - Val Loss: 1.4606, Val Acc: 25.00%
2025-04-04 08:31:34,995 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:34,995 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:34,995 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:34,995 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,106 - INFO - Epoch 27/50 - Train Loss: 1.4307, Train Acc: 24.44% - Val Loss: 1.4416, Val Acc: 25.00%
2025-04-04 08:31:35,106 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,106 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,106 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,106 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,213 - INFO - Epoch 28/50 - Train Loss: 1.3056, Train Acc: 31.11% - Val Loss: 1.4430, Val Acc: 25.00%
2025-04-04 08:31:35,214 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,214 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,214 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,214 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,214 - INFO - EarlyStopping counter: 1/10
2025-04-04 08:31:35,322 - INFO - Epoch 29/50 - Train Loss: 1.3542, Train Acc: 22.22% - Val Loss: 1.4327, Val Acc: 25.00%
2025-04-04 08:31:35,323 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,323 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,323 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,323 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,442 - INFO - Epoch 30/50 - Train Loss: 1.4110, Train Acc: 13.33% - Val Loss: 1.4239, Val Acc: 25.00%
2025-04-04 08:31:35,443 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,443 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,443 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,443 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,444 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch30.pth
2025-04-04 08:31:35,551 - INFO - Epoch 31/50 - Train Loss: 1.3218, Train Acc: 28.89% - Val Loss: 1.4161, Val Acc: 25.00%
2025-04-04 08:31:35,551 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,551 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,551 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,551 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,658 - INFO - Epoch 32/50 - Train Loss: 1.4520, Train Acc: 17.78% - Val Loss: 1.4091, Val Acc: 25.00%
2025-04-04 08:31:35,658 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,658 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,658 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,658 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,771 - INFO - Epoch 33/50 - Train Loss: 1.3307, Train Acc: 22.22% - Val Loss: 1.4081, Val Acc: 25.00%
2025-04-04 08:31:35,771 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,771 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,771 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,771 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,882 - INFO - Epoch 34/50 - Train Loss: 1.4502, Train Acc: 13.33% - Val Loss: 1.4065, Val Acc: 25.00%
2025-04-04 08:31:35,882 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,882 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,882 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,882 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,992 - INFO - Epoch 35/50 - Train Loss: 1.3150, Train Acc: 26.67% - Val Loss: 1.4044, Val Acc: 25.00%
2025-04-04 08:31:35,992 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:35,992 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:35,992 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:35,992 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:35,993 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch35.pth
2025-04-04 08:31:36,107 - INFO - Epoch 36/50 - Train Loss: 1.3343, Train Acc: 33.33% - Val Loss: 1.4044, Val Acc: 25.00%
2025-04-04 08:31:36,107 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,107 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,107 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,107 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,107 - INFO - EarlyStopping counter: 1/10
2025-04-04 08:31:36,249 - INFO - Epoch 37/50 - Train Loss: 1.3519, Train Acc: 24.44% - Val Loss: 1.4002, Val Acc: 25.00%
2025-04-04 08:31:36,249 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,249 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,249 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,249 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,356 - INFO - Epoch 38/50 - Train Loss: 1.3558, Train Acc: 26.67% - Val Loss: 1.4038, Val Acc: 25.00%
2025-04-04 08:31:36,356 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,356 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,356 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,356 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,356 - INFO - EarlyStopping counter: 1/10
2025-04-04 08:31:36,468 - INFO - Epoch 39/50 - Train Loss: 1.3762, Train Acc: 28.89% - Val Loss: 1.4053, Val Acc: 25.00%
2025-04-04 08:31:36,468 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,468 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,468 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,468 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,468 - INFO - EarlyStopping counter: 2/10
2025-04-04 08:31:36,573 - INFO - Epoch 40/50 - Train Loss: 1.2942, Train Acc: 33.33% - Val Loss: 1.4067, Val Acc: 25.00%
2025-04-04 08:31:36,574 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,574 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,574 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,574 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,574 - INFO - EarlyStopping counter: 3/10
2025-04-04 08:31:36,574 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 08:31:36,575 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch40.pth
2025-04-04 08:31:36,690 - INFO - Epoch 41/50 - Train Loss: 1.3233, Train Acc: 28.89% - Val Loss: 1.4111, Val Acc: 25.00%
2025-04-04 08:31:36,691 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,691 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,691 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,691 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,691 - INFO - EarlyStopping counter: 9/10
2025-04-04 08:31:36,691 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 08:31:36,812 - INFO - Epoch 42/50 - Train Loss: 1.2820, Train Acc: 37.78% - Val Loss: 1.4155, Val Acc: 25.00%
2025-04-04 08:31:36,812 - INFO - Klassenweise Genauigkeiten:
2025-04-04 08:31:36,812 - INFO -   basic: 0.00% (0/8)
2025-04-04 08:31:36,812 - INFO -   combined: 100.00% (3/3)
2025-04-04 08:31:36,812 - INFO -   mixed: 0.00% (0/1)
2025-04-04 08:31:36,812 - INFO - EarlyStopping counter: 10/10
2025-04-04 08:31:36,812 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 08:31:36,812 - INFO - Early Stopping in Epoche 42
2025-04-04 08:31:36,812 - INFO - Training abgeschlossen in 5.11 Sekunden
2025-04-04 08:31:36,812 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-04 08:31:36,813 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-04 08:31:36,814 - INFO - Starte detaillierte Modellevaluierung...
2025-04-04 08:31:36,860 - INFO - 
==================================================
2025-04-04 08:31:36,860 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-04 08:31:36,860 - INFO - ==================================================
2025-04-04 08:31:36,860 - INFO - Gesamtgenauigkeit: 25.00%
2025-04-04 08:31:36,860 - INFO - Makro-Präzision: 0.0417
2025-04-04 08:31:36,860 - INFO - Makro-Recall: 0.1667
2025-04-04 08:31:36,860 - INFO - Makro-F1: 0.0667
2025-04-04 08:31:36,860 - INFO - Mikro-F1 (Genauigkeit): 0.2500
2025-04-04 08:31:36,860 - INFO - 
Klassenweise Leistung:
2025-04-04 08:31:36,861 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-04 08:31:36,861 - INFO - ------------------------------------------------------------
2025-04-04 08:31:36,861 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-04 08:31:36,861 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-04 08:31:36,861 - INFO - combined        0.2500      1.0000      0.4000      3
2025-04-04 08:31:36,861 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-04 08:31:36,861 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-04 08:31:36,861 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-04 08:31:36,861 - INFO - 
Top-5 häufigste Fehler:
2025-04-04 08:31:36,861 - INFO - 1. basic als combined klassifiziert: 8 Fälle
2025-04-04 08:31:36,861 - INFO - 2. mixed als combined klassifiziert: 1 Fälle
2025-04-04 08:31:36,861 - INFO - 
Konfusionsmatrix:
2025-04-04 08:31:36,861 - INFO -     0     0     8     0     0     0
    0     0     0     0     0     0
    0     0     3     0     0     0
    0     0     1     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-04 08:31:36,861 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-04 08:31:36,861 - INFO - Erstelle Visualisierungen...
2025-04-04 08:31:37,589 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-04 08:31:37,589 - INFO - Starting calibration and quantization of the model...
2025-04-04 08:31:37,649 - INFO - Calibrating with 40 representative samples
2025-04-04 08:31:38,053 - WARNING - Quantization failed: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-04 08:31:38,054 - WARNING - Using non-quantized model for export
2025-04-04 08:31:38,055 - INFO - Original float32 model saved to: models_optimized/pizza_model_float32.pth
2025-04-04 08:31:38,055 - INFO - Float32 model size: 9.24 KB
2025-04-04 08:31:38,055 - INFO - Theoretical int8 size would be approximately: 2.31 KB
2025-04-04 08:31:38,055 - INFO - Exporting model for RP2040 microcontroller...
2025-04-04 08:31:38,081 - ERROR - Error exporting model: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument weight in method wrapper_CUDA___slow_conv2d_forward)
2025-04-04 08:31:38,082 - WARNING - Falling back to documentation-only export
2025-04-04 08:31:38,082 - INFO - 
================================================================================
2025-04-04 08:31:38,082 - INFO - ZUSAMMENFASSUNG DES OPTIMIERUNGSPROZESSES
2025-04-04 08:31:38,082 - INFO - ================================================================================
2025-04-04 08:31:38,082 - INFO - Gesamtzeit: 0.12 Minuten
2025-04-04 08:31:38,082 - INFO - Modellgröße: 9.24 KB (quantisiert)
2025-04-04 08:31:38,082 - INFO - Genauigkeit: 25.00%
2025-04-04 08:31:38,082 - INFO - Makro-F1-Score: 0.0667
2025-04-04 08:31:38,082 - INFO - Export-Verzeichnis: models_optimized/rp2040_export
2025-04-04 08:31:38,082 - INFO - ================================================================================
2025-04-04 08:31:38,083 - INFO - Abschließende README erstellt: models_optimized/README.md
2025-04-04 15:51:21,965 - INFO - ================================================================================
2025-04-04 15:51:21,965 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-04 15:51:21,965 - INFO - ================================================================================
2025-04-04 15:51:21,965 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-04 15:51:21,965 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-04 15:51:21,965 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-04 15:51:21,965 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-04 15:51:21,965 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-04 15:51:21,965 - INFO - ================================================================================
2025-04-04 15:51:21,966 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-04 15:51:22,014 - INFO - Datensatzanalyse abgeschlossen:
2025-04-04 15:51:22,014 - INFO - Gesamtzahl der Bilder: 57
2025-04-04 15:51:22,014 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-04 15:51:22,014 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-04 15:51:22,014 - INFO - RGB-Mittelwerte: [0.4915, 0.4075, 0.3344]
2025-04-04 15:51:22,014 - INFO - RGB-Standardabweichungen: [0.2377, 0.2570, 0.2703]
2025-04-04 15:51:22,014 - INFO - Preparing optimized data loaders...
2025-04-04 15:51:22,014 - INFO - Using dataset-specific normalization: mean=[0.49147037 0.40745625 0.33437747], std=[0.23768873 0.25702648 0.27033943]
2025-04-04 15:51:22,016 - INFO - Data loaders created: 45 training images, 12 validation images
2025-04-04 15:51:22,016 - INFO - Classes: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-04 15:51:22,189 - INFO - Modell erstellt mit 582 Parametern
2025-04-04 15:51:22,560 - INFO - Speicheranalyse:
2025-04-04 15:51:22,560 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 15:51:22,560 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 15:51:22,560 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 15:51:22,560 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 15:51:22,560 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 15:51:22,560 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-04 15:51:22,561 - INFO - Speicheranalyse:
2025-04-04 15:51:22,561 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 15:51:22,561 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 15:51:22,561 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 15:51:22,561 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 15:51:22,561 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 15:51:22,624 - INFO - Klassengewichte für Loss-Funktion: [1.25, 0.62, 0.54, 0.58, 1.0, 1.0]
2025-04-04 15:51:23,094 - INFO - Epoch 1/50 - Train Loss: 1.7878, Train Acc: 28.89% - Val Loss: 1.7969, Val Acc: 0.00%
2025-04-04 15:51:23,094 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,094 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,094 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,094 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,204 - INFO - Epoch 2/50 - Train Loss: 1.7887, Train Acc: 22.22% - Val Loss: 1.7982, Val Acc: 0.00%
2025-04-04 15:51:23,204 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,204 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,204 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,204 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,204 - INFO - EarlyStopping counter: 1/10
2025-04-04 15:51:23,320 - INFO - Epoch 3/50 - Train Loss: 1.7821, Train Acc: 22.22% - Val Loss: 1.7982, Val Acc: 0.00%
2025-04-04 15:51:23,320 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,320 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,320 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,320 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,320 - INFO - EarlyStopping counter: 2/10
2025-04-04 15:51:23,429 - INFO - Epoch 4/50 - Train Loss: 1.7690, Train Acc: 28.89% - Val Loss: 1.7965, Val Acc: 0.00%
2025-04-04 15:51:23,429 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,429 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,429 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,429 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,429 - INFO - EarlyStopping counter: 3/10
2025-04-04 15:51:23,542 - INFO - Epoch 5/50 - Train Loss: 1.7761, Train Acc: 28.89% - Val Loss: 1.7919, Val Acc: 0.00%
2025-04-04 15:51:23,542 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,542 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,543 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,543 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,549 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-04 15:51:23,662 - INFO - Epoch 6/50 - Train Loss: 1.7613, Train Acc: 26.67% - Val Loss: 1.7847, Val Acc: 0.00%
2025-04-04 15:51:23,662 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,662 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,662 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,662 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,780 - INFO - Epoch 7/50 - Train Loss: 1.7527, Train Acc: 31.11% - Val Loss: 1.7738, Val Acc: 0.00%
2025-04-04 15:51:23,780 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,780 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,780 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,780 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:23,893 - INFO - Epoch 8/50 - Train Loss: 1.7197, Train Acc: 55.56% - Val Loss: 1.7601, Val Acc: 0.00%
2025-04-04 15:51:23,894 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:23,894 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:23,894 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:23,894 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,014 - INFO - Epoch 9/50 - Train Loss: 1.7208, Train Acc: 26.67% - Val Loss: 1.7413, Val Acc: 0.00%
2025-04-04 15:51:24,015 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,015 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:24,015 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,015 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,124 - INFO - Epoch 10/50 - Train Loss: 1.6843, Train Acc: 26.67% - Val Loss: 1.7127, Val Acc: 0.00%
2025-04-04 15:51:24,124 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,124 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:24,124 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,124 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,126 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-04 15:51:24,246 - INFO - Epoch 11/50 - Train Loss: 1.6703, Train Acc: 31.11% - Val Loss: 1.6781, Val Acc: 0.00%
2025-04-04 15:51:24,246 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,246 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:24,247 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,247 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,367 - INFO - Epoch 12/50 - Train Loss: 1.6291, Train Acc: 37.78% - Val Loss: 1.6447, Val Acc: 0.00%
2025-04-04 15:51:24,367 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,367 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:51:24,367 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,367 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,490 - INFO - Epoch 13/50 - Train Loss: 1.5753, Train Acc: 44.44% - Val Loss: 1.5952, Val Acc: 50.00%
2025-04-04 15:51:24,490 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,490 - INFO -   basic: 75.00% (6/8)
2025-04-04 15:51:24,490 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,490 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,491 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch13.pth
2025-04-04 15:51:24,606 - INFO - Epoch 14/50 - Train Loss: 1.5875, Train Acc: 20.00% - Val Loss: 1.5560, Val Acc: 66.67%
2025-04-04 15:51:24,606 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,606 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:24,606 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,606 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,607 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch14.pth
2025-04-04 15:51:24,730 - INFO - Epoch 15/50 - Train Loss: 1.5413, Train Acc: 24.44% - Val Loss: 1.5161, Val Acc: 66.67%
2025-04-04 15:51:24,730 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,730 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:24,730 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,730 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,733 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-04 15:51:24,845 - INFO - Epoch 16/50 - Train Loss: 1.5291, Train Acc: 22.22% - Val Loss: 1.4825, Val Acc: 66.67%
2025-04-04 15:51:24,846 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,846 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:24,846 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,846 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:24,963 - INFO - Epoch 17/50 - Train Loss: 1.5038, Train Acc: 22.22% - Val Loss: 1.4519, Val Acc: 66.67%
2025-04-04 15:51:24,963 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:24,963 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:24,963 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:24,963 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,078 - INFO - Epoch 18/50 - Train Loss: 1.4908, Train Acc: 22.22% - Val Loss: 1.4259, Val Acc: 66.67%
2025-04-04 15:51:25,078 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,078 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,078 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,078 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,189 - INFO - Epoch 19/50 - Train Loss: 1.4883, Train Acc: 28.89% - Val Loss: 1.3976, Val Acc: 66.67%
2025-04-04 15:51:25,189 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,189 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,189 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,189 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,310 - INFO - Epoch 20/50 - Train Loss: 1.4406, Train Acc: 31.11% - Val Loss: 1.3490, Val Acc: 66.67%
2025-04-04 15:51:25,310 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,310 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,310 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,310 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,311 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-04 15:51:25,426 - INFO - Epoch 21/50 - Train Loss: 1.4039, Train Acc: 33.33% - Val Loss: 1.2856, Val Acc: 66.67%
2025-04-04 15:51:25,427 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,427 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,427 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,427 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,550 - INFO - Epoch 22/50 - Train Loss: 1.4569, Train Acc: 22.22% - Val Loss: 1.2416, Val Acc: 66.67%
2025-04-04 15:51:25,550 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,550 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,550 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,550 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,660 - INFO - Epoch 23/50 - Train Loss: 1.4296, Train Acc: 15.56% - Val Loss: 1.2139, Val Acc: 66.67%
2025-04-04 15:51:25,660 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,660 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,660 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,660 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,784 - INFO - Epoch 24/50 - Train Loss: 1.4015, Train Acc: 26.67% - Val Loss: 1.1881, Val Acc: 66.67%
2025-04-04 15:51:25,784 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,784 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,784 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,784 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,895 - INFO - Epoch 25/50 - Train Loss: 1.3555, Train Acc: 26.67% - Val Loss: 1.1646, Val Acc: 66.67%
2025-04-04 15:51:25,895 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:25,895 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:25,895 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:25,895 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:25,896 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-04 15:51:26,009 - INFO - Epoch 26/50 - Train Loss: 1.3263, Train Acc: 26.67% - Val Loss: 1.1301, Val Acc: 66.67%
2025-04-04 15:51:26,010 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,010 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,010 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:26,010 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,128 - INFO - Epoch 27/50 - Train Loss: 1.3661, Train Acc: 22.22% - Val Loss: 1.1072, Val Acc: 66.67%
2025-04-04 15:51:26,128 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,128 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,128 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:26,128 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,240 - INFO - Epoch 28/50 - Train Loss: 1.4441, Train Acc: 17.78% - Val Loss: 1.0901, Val Acc: 66.67%
2025-04-04 15:51:26,240 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,240 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,240 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:51:26,240 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,362 - INFO - Epoch 29/50 - Train Loss: 1.3921, Train Acc: 17.78% - Val Loss: 1.0844, Val Acc: 75.00%
2025-04-04 15:51:26,362 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,362 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,362 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,362 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,364 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch29.pth
2025-04-04 15:51:26,475 - INFO - Epoch 30/50 - Train Loss: 1.3277, Train Acc: 26.67% - Val Loss: 1.0861, Val Acc: 75.00%
2025-04-04 15:51:26,475 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,475 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,475 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,475 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,475 - INFO - EarlyStopping counter: 1/10
2025-04-04 15:51:26,477 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch30.pth
2025-04-04 15:51:26,589 - INFO - Epoch 31/50 - Train Loss: 1.3694, Train Acc: 24.44% - Val Loss: 1.0835, Val Acc: 75.00%
2025-04-04 15:51:26,589 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,589 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,589 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,589 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,589 - INFO - EarlyStopping counter: 2/10
2025-04-04 15:51:26,704 - INFO - Epoch 32/50 - Train Loss: 1.4110, Train Acc: 17.78% - Val Loss: 1.0850, Val Acc: 75.00%
2025-04-04 15:51:26,704 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,704 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,704 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,704 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,704 - INFO - EarlyStopping counter: 3/10
2025-04-04 15:51:26,811 - INFO - Epoch 33/50 - Train Loss: 1.4347, Train Acc: 13.33% - Val Loss: 1.0861, Val Acc: 75.00%
2025-04-04 15:51:26,811 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,811 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,811 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,811 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,811 - INFO - EarlyStopping counter: 4/10
2025-04-04 15:51:26,920 - INFO - Epoch 34/50 - Train Loss: 1.2933, Train Acc: 28.89% - Val Loss: 1.0970, Val Acc: 75.00%
2025-04-04 15:51:26,920 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:26,921 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:26,921 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:26,921 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:26,921 - INFO - EarlyStopping counter: 5/10
2025-04-04 15:51:26,921 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:51:27,043 - INFO - Epoch 35/50 - Train Loss: 1.3302, Train Acc: 33.33% - Val Loss: 1.1082, Val Acc: 75.00%
2025-04-04 15:51:27,043 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:27,043 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:27,043 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:27,043 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:27,043 - INFO - EarlyStopping counter: 9/10
2025-04-04 15:51:27,043 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:51:27,044 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch35.pth
2025-04-04 15:51:27,155 - INFO - Epoch 36/50 - Train Loss: 1.2955, Train Acc: 33.33% - Val Loss: 1.1123, Val Acc: 75.00%
2025-04-04 15:51:27,155 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:51:27,155 - INFO -   basic: 100.00% (8/8)
2025-04-04 15:51:27,155 - INFO -   combined: 33.33% (1/3)
2025-04-04 15:51:27,155 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:51:27,155 - INFO - EarlyStopping counter: 10/10
2025-04-04 15:51:27,155 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:51:27,155 - INFO - Early Stopping in Epoche 36
2025-04-04 15:51:27,156 - INFO - Training abgeschlossen in 4.53 Sekunden
2025-04-04 15:51:27,156 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-04 15:51:27,157 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-04 15:51:27,158 - INFO - Starte detaillierte Modellevaluierung...
2025-04-04 15:51:27,205 - INFO - 
==================================================
2025-04-04 15:51:27,205 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-04 15:51:27,205 - INFO - ==================================================
2025-04-04 15:51:27,205 - INFO - Gesamtgenauigkeit: 75.00%
2025-04-04 15:51:27,205 - INFO - Makro-Präzision: 0.2879
2025-04-04 15:51:27,205 - INFO - Makro-Recall: 0.2222
2025-04-04 15:51:27,205 - INFO - Makro-F1: 0.2237
2025-04-04 15:51:27,205 - INFO - Mikro-F1 (Genauigkeit): 0.7500
2025-04-04 15:51:27,205 - INFO - 
Klassenweise Leistung:
2025-04-04 15:51:27,205 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-04 15:51:27,205 - INFO - ------------------------------------------------------------
2025-04-04 15:51:27,205 - INFO - basic           0.7273      1.0000      0.8421      8
2025-04-04 15:51:27,205 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-04 15:51:27,205 - INFO - combined        1.0000      0.3333      0.5000      3
2025-04-04 15:51:27,205 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-04 15:51:27,205 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-04 15:51:27,205 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-04 15:51:27,205 - INFO - 
Top-5 häufigste Fehler:
2025-04-04 15:51:27,205 - INFO - 1. combined als basic klassifiziert: 2 Fälle
2025-04-04 15:51:27,205 - INFO - 2. mixed als basic klassifiziert: 1 Fälle
2025-04-04 15:51:27,205 - INFO - 
Konfusionsmatrix:
2025-04-04 15:51:27,205 - INFO -     8     0     0     0     0     0
    0     0     0     0     0     0
    2     0     1     0     0     0
    1     0     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-04 15:51:27,205 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-04 15:51:27,206 - INFO - Erstelle Visualisierungen...
2025-04-04 15:51:28,109 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-04 15:51:28,109 - INFO - Starting calibration and quantization of the model...
2025-04-04 15:51:28,170 - INFO - Calibrating with 35 representative samples
2025-04-04 15:51:28,585 - WARNING - Quantization failed: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-04 15:51:28,585 - WARNING - Using non-quantized model for export
2025-04-04 15:51:28,587 - INFO - Original float32 model saved to: models_optimized/pizza_model_float32.pth
2025-04-04 15:51:28,587 - INFO - Float32 model size: 9.24 KB
2025-04-04 15:51:28,587 - INFO - Theoretical int8 size would be approximately: 2.31 KB
2025-04-04 15:51:28,587 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-04 15:51:28,587 - ERROR - Fehler im Optimierungsprozess: 'list' object has no attribute 'MODEL_DIR'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 2797, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1903, in export_to_microcontroller
    export_dir = os.path.join(config.MODEL_DIR, "rp2040_export")
                              ^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'MODEL_DIR'
2025-04-04 15:56:26,079 - INFO - ================================================================================
2025-04-04 15:56:26,079 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-04 15:56:26,079 - INFO - ================================================================================
2025-04-04 15:56:26,079 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-04 15:56:26,079 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-04 15:56:26,079 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-04 15:56:26,080 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-04 15:56:26,080 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-04 15:56:26,080 - INFO - ================================================================================
2025-04-04 15:56:26,080 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-04 15:56:26,112 - INFO - Datensatzanalyse abgeschlossen:
2025-04-04 15:56:26,112 - INFO - Gesamtzahl der Bilder: 57
2025-04-04 15:56:26,112 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-04 15:56:26,112 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-04 15:56:26,112 - INFO - RGB-Mittelwerte: [0.4708, 0.3955, 0.3301]
2025-04-04 15:56:26,112 - INFO - RGB-Standardabweichungen: [0.2273, 0.2499, 0.2644]
2025-04-04 15:56:26,112 - INFO - Preparing optimized data loaders...
2025-04-04 15:56:26,113 - INFO - Using dataset-specific normalization: mean=[0.47082786 0.39545751 0.33005449], std=[0.22730555 0.24990258 0.26444825]
2025-04-04 15:56:26,114 - INFO - Data loaders created: 45 training images, 12 validation images
2025-04-04 15:56:26,114 - INFO - Classes: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-04 15:56:26,263 - INFO - Modell erstellt mit 582 Parametern
2025-04-04 15:56:26,385 - INFO - Speicheranalyse:
2025-04-04 15:56:26,385 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 15:56:26,385 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 15:56:26,385 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 15:56:26,385 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 15:56:26,385 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 15:56:26,385 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-04 15:56:26,386 - INFO - Speicheranalyse:
2025-04-04 15:56:26,386 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 15:56:26,386 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 15:56:26,386 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 15:56:26,386 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 15:56:26,386 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 15:56:26,440 - INFO - Klassengewichte für Loss-Funktion: [0.68, 1.07, 0.44, 0.75, 1.0, 1.0]
2025-04-04 15:56:26,684 - INFO - Epoch 1/50 - Train Loss: 1.7867, Train Acc: 22.22% - Val Loss: 1.7935, Val Acc: 25.00%
2025-04-04 15:56:26,684 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:26,684 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:26,684 - INFO -   combined: 100.00% (3/3)
2025-04-04 15:56:26,684 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:26,686 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-04 15:56:26,793 - INFO - Epoch 2/50 - Train Loss: 1.7893, Train Acc: 13.33% - Val Loss: 1.7935, Val Acc: 25.00%
2025-04-04 15:56:26,794 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:26,794 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:26,794 - INFO -   combined: 100.00% (3/3)
2025-04-04 15:56:26,794 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:26,794 - INFO - EarlyStopping counter: 1/10
2025-04-04 15:56:26,904 - INFO - Epoch 3/50 - Train Loss: 1.7777, Train Acc: 17.78% - Val Loss: 1.7936, Val Acc: 25.00%
2025-04-04 15:56:26,904 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:26,904 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:26,904 - INFO -   combined: 100.00% (3/3)
2025-04-04 15:56:26,904 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:26,904 - INFO - EarlyStopping counter: 2/10
2025-04-04 15:56:27,015 - INFO - Epoch 4/50 - Train Loss: 1.7680, Train Acc: 33.33% - Val Loss: 1.7936, Val Acc: 25.00%
2025-04-04 15:56:27,015 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,015 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,015 - INFO -   combined: 100.00% (3/3)
2025-04-04 15:56:27,015 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,015 - INFO - EarlyStopping counter: 3/10
2025-04-04 15:56:27,123 - INFO - Epoch 5/50 - Train Loss: 1.7615, Train Acc: 24.44% - Val Loss: 1.7942, Val Acc: 0.00%
2025-04-04 15:56:27,123 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,123 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,123 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,123 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,123 - INFO - EarlyStopping counter: 4/10
2025-04-04 15:56:27,123 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:56:27,124 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-04 15:56:27,233 - INFO - Epoch 6/50 - Train Loss: 1.7442, Train Acc: 37.78% - Val Loss: 1.7938, Val Acc: 0.00%
2025-04-04 15:56:27,233 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,233 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,234 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,234 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,234 - INFO - EarlyStopping counter: 9/10
2025-04-04 15:56:27,234 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:56:27,348 - INFO - Epoch 7/50 - Train Loss: 1.7409, Train Acc: 31.11% - Val Loss: 1.7912, Val Acc: 0.00%
2025-04-04 15:56:27,348 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,348 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,348 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,348 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,462 - INFO - Epoch 8/50 - Train Loss: 1.7195, Train Acc: 26.67% - Val Loss: 1.7848, Val Acc: 0.00%
2025-04-04 15:56:27,462 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,462 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,463 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,463 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,567 - INFO - Epoch 9/50 - Train Loss: 1.6776, Train Acc: 51.11% - Val Loss: 1.7783, Val Acc: 0.00%
2025-04-04 15:56:27,568 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,568 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,568 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,568 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,679 - INFO - Epoch 10/50 - Train Loss: 1.6610, Train Acc: 37.78% - Val Loss: 1.7722, Val Acc: 0.00%
2025-04-04 15:56:27,679 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,679 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,679 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,679 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,681 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-04 15:56:27,787 - INFO - Epoch 11/50 - Train Loss: 1.6727, Train Acc: 24.44% - Val Loss: 1.7606, Val Acc: 0.00%
2025-04-04 15:56:27,788 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,788 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,788 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,788 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,892 - INFO - Epoch 12/50 - Train Loss: 1.5899, Train Acc: 33.33% - Val Loss: 1.7516, Val Acc: 0.00%
2025-04-04 15:56:27,892 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,892 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,892 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:27,892 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:27,999 - INFO - Epoch 13/50 - Train Loss: 1.5884, Train Acc: 26.67% - Val Loss: 1.7382, Val Acc: 0.00%
2025-04-04 15:56:27,999 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:27,999 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:27,999 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,000 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,111 - INFO - Epoch 14/50 - Train Loss: 1.4959, Train Acc: 40.00% - Val Loss: 1.7277, Val Acc: 0.00%
2025-04-04 15:56:28,111 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,111 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,111 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,111 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,216 - INFO - Epoch 15/50 - Train Loss: 1.4863, Train Acc: 37.78% - Val Loss: 1.7083, Val Acc: 0.00%
2025-04-04 15:56:28,216 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,216 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,216 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,216 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,218 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-04 15:56:28,330 - INFO - Epoch 16/50 - Train Loss: 1.5504, Train Acc: 20.00% - Val Loss: 1.6904, Val Acc: 0.00%
2025-04-04 15:56:28,330 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,330 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,330 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,330 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,440 - INFO - Epoch 17/50 - Train Loss: 1.4978, Train Acc: 24.44% - Val Loss: 1.6805, Val Acc: 0.00%
2025-04-04 15:56:28,441 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,441 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,441 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,441 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,549 - INFO - Epoch 18/50 - Train Loss: 1.4474, Train Acc: 31.11% - Val Loss: 1.6776, Val Acc: 0.00%
2025-04-04 15:56:28,549 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,549 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,549 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,549 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,670 - INFO - Epoch 19/50 - Train Loss: 1.4357, Train Acc: 28.89% - Val Loss: 1.6762, Val Acc: 0.00%
2025-04-04 15:56:28,670 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,670 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,670 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,670 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,783 - INFO - Epoch 20/50 - Train Loss: 1.4478, Train Acc: 31.11% - Val Loss: 1.6795, Val Acc: 0.00%
2025-04-04 15:56:28,783 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,783 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,783 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,783 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,783 - INFO - EarlyStopping counter: 1/10
2025-04-04 15:56:28,784 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-04 15:56:28,894 - INFO - Epoch 21/50 - Train Loss: 1.5142, Train Acc: 13.33% - Val Loss: 1.6853, Val Acc: 0.00%
2025-04-04 15:56:28,894 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:28,894 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:28,894 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:28,894 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:28,894 - INFO - EarlyStopping counter: 2/10
2025-04-04 15:56:29,012 - INFO - Epoch 22/50 - Train Loss: 1.2814, Train Acc: 42.22% - Val Loss: 1.6960, Val Acc: 0.00%
2025-04-04 15:56:29,012 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:29,012 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:29,012 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:29,012 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:29,012 - INFO - EarlyStopping counter: 3/10
2025-04-04 15:56:29,012 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:56:29,121 - INFO - Epoch 23/50 - Train Loss: 1.3399, Train Acc: 35.56% - Val Loss: 1.7074, Val Acc: 0.00%
2025-04-04 15:56:29,121 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:29,121 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:29,121 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:29,121 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:29,121 - INFO - EarlyStopping counter: 9/10
2025-04-04 15:56:29,121 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:56:29,243 - INFO - Epoch 24/50 - Train Loss: 1.3839, Train Acc: 26.67% - Val Loss: 1.7185, Val Acc: 0.00%
2025-04-04 15:56:29,243 - INFO - Klassenweise Genauigkeiten:
2025-04-04 15:56:29,243 - INFO -   basic: 0.00% (0/8)
2025-04-04 15:56:29,243 - INFO -   combined: 0.00% (0/3)
2025-04-04 15:56:29,243 - INFO -   mixed: 0.00% (0/1)
2025-04-04 15:56:29,243 - INFO - EarlyStopping counter: 10/10
2025-04-04 15:56:29,243 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 15:56:29,243 - INFO - Early Stopping in Epoche 24
2025-04-04 15:56:29,243 - INFO - Training abgeschlossen in 2.80 Sekunden
2025-04-04 15:56:29,244 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-04 15:56:29,245 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-04 15:56:29,245 - INFO - Starte detaillierte Modellevaluierung...
2025-04-04 15:56:29,292 - INFO - 
==================================================
2025-04-04 15:56:29,292 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-04 15:56:29,292 - INFO - ==================================================
2025-04-04 15:56:29,292 - INFO - Gesamtgenauigkeit: 0.00%
2025-04-04 15:56:29,292 - INFO - Makro-Präzision: 0.0000
2025-04-04 15:56:29,292 - INFO - Makro-Recall: 0.0000
2025-04-04 15:56:29,292 - INFO - Makro-F1: 0.0000
2025-04-04 15:56:29,292 - INFO - Mikro-F1 (Genauigkeit): 0.0000
2025-04-04 15:56:29,292 - INFO - 
Klassenweise Leistung:
2025-04-04 15:56:29,292 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-04 15:56:29,292 - INFO - ------------------------------------------------------------
2025-04-04 15:56:29,292 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-04 15:56:29,292 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-04 15:56:29,292 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-04 15:56:29,292 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-04 15:56:29,292 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-04 15:56:29,292 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-04 15:56:29,292 - INFO - 
Top-5 häufigste Fehler:
2025-04-04 15:56:29,292 - INFO - 1. basic als burnt klassifiziert: 8 Fälle
2025-04-04 15:56:29,292 - INFO - 2. combined als burnt klassifiziert: 3 Fälle
2025-04-04 15:56:29,292 - INFO - 3. mixed als burnt klassifiziert: 1 Fälle
2025-04-04 15:56:29,292 - INFO - 
Konfusionsmatrix:
2025-04-04 15:56:29,292 - INFO -     0     8     0     0     0     0
    0     0     0     0     0     0
    0     3     0     0     0     0
    0     1     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-04 15:56:29,293 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-04 15:56:29,293 - INFO - Erstelle Visualisierungen...
2025-04-04 15:56:29,988 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-04 15:56:29,988 - INFO - Starting calibration and quantization of the model...
2025-04-04 15:56:30,054 - INFO - Calibrating with 37 representative samples
2025-04-04 15:56:30,414 - WARNING - Quantization failed: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-04 15:56:30,414 - WARNING - Using non-quantized model for export
2025-04-04 15:56:30,415 - INFO - Original float32 model saved to: models_optimized/pizza_model_float32.pth
2025-04-04 15:56:30,415 - INFO - Float32 model size: 9.24 KB
2025-04-04 15:56:30,415 - INFO - Theoretical int8 size would be approximately: 2.31 KB
2025-04-04 15:56:30,415 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-04 15:56:30,415 - ERROR - Fehler im Optimierungsprozess: 'list' object has no attribute 'MODEL_DIR'
Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 3083, in main
    export_results = export_to_microcontroller(trained_model, config, class_names, preprocessing_params, quantization_results)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 2190, in export_to_microcontroller
    export_dir = os.path.join(config.MODEL_DIR, "rp2040_export")
                              ^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'MODEL_DIR'
2025-04-04 16:00:00,609 - INFO - ================================================================================
2025-04-04 16:00:00,609 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-04 16:00:00,610 - INFO - ================================================================================
2025-04-04 16:00:00,610 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-04 16:00:00,610 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-04 16:00:00,610 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-04 16:00:00,610 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-04 16:00:00,610 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-04 16:00:00,610 - INFO - ================================================================================
2025-04-04 16:00:00,610 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-04 16:00:00,643 - INFO - Datensatzanalyse abgeschlossen:
2025-04-04 16:00:00,643 - INFO - Gesamtzahl der Bilder: 57
2025-04-04 16:00:00,643 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-04 16:00:00,643 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-04 16:00:00,643 - INFO - RGB-Mittelwerte: [0.4862, 0.4004, 0.3320]
2025-04-04 16:00:00,643 - INFO - RGB-Standardabweichungen: [0.2306, 0.2509, 0.2643]
2025-04-04 16:00:00,643 - INFO - Preparing optimized data loaders...
2025-04-04 16:00:00,643 - INFO - Using dataset-specific normalization: mean=[0.4862363  0.40037732 0.33202322], std=[0.23064844 0.25089512 0.26433779]
2025-04-04 16:00:00,644 - INFO - Data loaders created: 45 training images, 12 validation images
2025-04-04 16:00:00,644 - INFO - Classes: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-04 16:00:01,058 - INFO - Modell erstellt mit 582 Parametern
2025-04-04 16:00:01,262 - INFO - Speicheranalyse:
2025-04-04 16:00:01,263 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 16:00:01,263 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 16:00:01,263 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 16:00:01,263 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 16:00:01,263 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 16:00:01,263 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-04 16:00:01,264 - INFO - Speicheranalyse:
2025-04-04 16:00:01,264 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 16:00:01,264 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 16:00:01,264 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 16:00:01,264 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 16:00:01,264 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 16:00:01,318 - INFO - Klassengewichte für Loss-Funktion: [1.07, 0.5, 0.54, 0.83, 1.0, 1.0]
2025-04-04 16:00:01,572 - INFO - Epoch 1/50 - Train Loss: 1.7994, Train Acc: 8.89% - Val Loss: 1.7783, Val Acc: 66.67%
2025-04-04 16:00:01,572 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:01,572 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:01,572 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:01,572 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:01,574 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-04 16:00:01,691 - INFO - Epoch 2/50 - Train Loss: 1.7872, Train Acc: 17.78% - Val Loss: 1.7784, Val Acc: 66.67%
2025-04-04 16:00:01,691 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:01,691 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:01,691 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:01,692 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:01,692 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:00:01,811 - INFO - Epoch 3/50 - Train Loss: 1.7886, Train Acc: 17.78% - Val Loss: 1.7778, Val Acc: 66.67%
2025-04-04 16:00:01,811 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:01,811 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:01,811 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:01,811 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:01,811 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:00:01,929 - INFO - Epoch 4/50 - Train Loss: 1.7765, Train Acc: 26.67% - Val Loss: 1.7745, Val Acc: 66.67%
2025-04-04 16:00:01,929 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:01,929 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:01,929 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:01,929 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,054 - INFO - Epoch 5/50 - Train Loss: 1.7603, Train Acc: 26.67% - Val Loss: 1.7682, Val Acc: 66.67%
2025-04-04 16:00:02,054 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,054 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,054 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,054 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,055 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-04 16:00:02,172 - INFO - Epoch 6/50 - Train Loss: 1.7689, Train Acc: 13.33% - Val Loss: 1.7601, Val Acc: 66.67%
2025-04-04 16:00:02,172 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,172 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,172 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,172 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,298 - INFO - Epoch 7/50 - Train Loss: 1.7568, Train Acc: 15.56% - Val Loss: 1.7484, Val Acc: 66.67%
2025-04-04 16:00:02,298 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,298 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,298 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,298 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,418 - INFO - Epoch 8/50 - Train Loss: 1.7308, Train Acc: 24.44% - Val Loss: 1.7313, Val Acc: 66.67%
2025-04-04 16:00:02,418 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,418 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,418 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,418 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,535 - INFO - Epoch 9/50 - Train Loss: 1.7059, Train Acc: 24.44% - Val Loss: 1.7080, Val Acc: 66.67%
2025-04-04 16:00:02,535 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,535 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,535 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,535 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,647 - INFO - Epoch 10/50 - Train Loss: 1.6927, Train Acc: 26.67% - Val Loss: 1.6778, Val Acc: 66.67%
2025-04-04 16:00:02,647 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,647 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,647 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,647 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,649 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-04 16:00:02,763 - INFO - Epoch 11/50 - Train Loss: 1.6542, Train Acc: 28.89% - Val Loss: 1.6438, Val Acc: 66.67%
2025-04-04 16:00:02,763 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,763 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,763 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,763 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:02,890 - INFO - Epoch 12/50 - Train Loss: 1.6272, Train Acc: 24.44% - Val Loss: 1.5991, Val Acc: 66.67%
2025-04-04 16:00:02,890 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:02,890 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:02,890 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:02,890 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,003 - INFO - Epoch 13/50 - Train Loss: 1.6150, Train Acc: 15.56% - Val Loss: 1.5508, Val Acc: 66.67%
2025-04-04 16:00:03,003 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,003 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,003 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,003 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,126 - INFO - Epoch 14/50 - Train Loss: 1.5700, Train Acc: 17.78% - Val Loss: 1.5130, Val Acc: 66.67%
2025-04-04 16:00:03,126 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,126 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,126 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,126 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,248 - INFO - Epoch 15/50 - Train Loss: 1.5562, Train Acc: 20.00% - Val Loss: 1.4736, Val Acc: 66.67%
2025-04-04 16:00:03,248 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,248 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,248 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,248 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,250 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-04 16:00:03,375 - INFO - Epoch 16/50 - Train Loss: 1.4409, Train Acc: 31.11% - Val Loss: 1.4463, Val Acc: 66.67%
2025-04-04 16:00:03,375 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,375 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,375 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,376 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,493 - INFO - Epoch 17/50 - Train Loss: 1.5236, Train Acc: 17.78% - Val Loss: 1.4081, Val Acc: 66.67%
2025-04-04 16:00:03,493 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,493 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,493 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,493 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,608 - INFO - Epoch 18/50 - Train Loss: 1.5020, Train Acc: 17.78% - Val Loss: 1.3767, Val Acc: 66.67%
2025-04-04 16:00:03,608 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,609 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,609 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,609 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,736 - INFO - Epoch 19/50 - Train Loss: 1.5260, Train Acc: 15.56% - Val Loss: 1.3550, Val Acc: 66.67%
2025-04-04 16:00:03,736 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,736 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,736 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,736 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,848 - INFO - Epoch 20/50 - Train Loss: 1.5457, Train Acc: 8.89% - Val Loss: 1.3506, Val Acc: 66.67%
2025-04-04 16:00:03,848 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,848 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,848 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,848 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,850 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-04 16:00:03,969 - INFO - Epoch 21/50 - Train Loss: 1.3624, Train Acc: 28.89% - Val Loss: 1.3675, Val Acc: 66.67%
2025-04-04 16:00:03,969 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:03,970 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:03,970 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:03,970 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:03,970 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:00:04,091 - INFO - Epoch 22/50 - Train Loss: 1.4357, Train Acc: 15.56% - Val Loss: 1.3726, Val Acc: 66.67%
2025-04-04 16:00:04,091 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,091 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,091 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,091 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,091 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:00:04,215 - INFO - Epoch 23/50 - Train Loss: 1.4714, Train Acc: 20.00% - Val Loss: 1.3712, Val Acc: 75.00%
2025-04-04 16:00:04,215 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,215 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,215 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,215 - INFO -   mixed: 100.00% (1/1)
2025-04-04 16:00:04,215 - INFO - EarlyStopping counter: 3/10
2025-04-04 16:00:04,215 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:00:04,216 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch23.pth
2025-04-04 16:00:04,330 - INFO - Epoch 24/50 - Train Loss: 1.3517, Train Acc: 28.89% - Val Loss: 1.3457, Val Acc: 66.67%
2025-04-04 16:00:04,330 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,330 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,330 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,330 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,449 - INFO - Epoch 25/50 - Train Loss: 1.4204, Train Acc: 17.78% - Val Loss: 1.3293, Val Acc: 66.67%
2025-04-04 16:00:04,449 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,449 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,449 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,449 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,450 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-04 16:00:04,568 - INFO - Epoch 26/50 - Train Loss: 1.3839, Train Acc: 24.44% - Val Loss: 1.2997, Val Acc: 66.67%
2025-04-04 16:00:04,568 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,568 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,568 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,568 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,685 - INFO - Epoch 27/50 - Train Loss: 1.3375, Train Acc: 28.89% - Val Loss: 1.2662, Val Acc: 66.67%
2025-04-04 16:00:04,685 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,685 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,685 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,685 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,804 - INFO - Epoch 28/50 - Train Loss: 1.3484, Train Acc: 26.67% - Val Loss: 1.2344, Val Acc: 66.67%
2025-04-04 16:00:04,804 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,804 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,804 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,804 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:04,928 - INFO - Epoch 29/50 - Train Loss: 1.3814, Train Acc: 22.22% - Val Loss: 1.2143, Val Acc: 66.67%
2025-04-04 16:00:04,928 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:04,928 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:04,928 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:04,928 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,042 - INFO - Epoch 30/50 - Train Loss: 1.3477, Train Acc: 26.67% - Val Loss: 1.2088, Val Acc: 66.67%
2025-04-04 16:00:05,042 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,042 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,042 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,043 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,044 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch30.pth
2025-04-04 16:00:05,157 - INFO - Epoch 31/50 - Train Loss: 1.3069, Train Acc: 26.67% - Val Loss: 1.1764, Val Acc: 66.67%
2025-04-04 16:00:05,157 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,157 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,157 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,157 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,285 - INFO - Epoch 32/50 - Train Loss: 1.2571, Train Acc: 33.33% - Val Loss: 1.1516, Val Acc: 66.67%
2025-04-04 16:00:05,285 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,285 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,285 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,285 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,395 - INFO - Epoch 33/50 - Train Loss: 1.3508, Train Acc: 26.67% - Val Loss: 1.1198, Val Acc: 66.67%
2025-04-04 16:00:05,396 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,396 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,396 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,396 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,512 - INFO - Epoch 34/50 - Train Loss: 1.4384, Train Acc: 13.33% - Val Loss: 1.1115, Val Acc: 66.67%
2025-04-04 16:00:05,512 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,512 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,512 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,512 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,626 - INFO - Epoch 35/50 - Train Loss: 1.4385, Train Acc: 15.56% - Val Loss: 1.1143, Val Acc: 66.67%
2025-04-04 16:00:05,627 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,627 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,627 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,627 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,627 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:00:05,629 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch35.pth
2025-04-04 16:00:05,749 - INFO - Epoch 36/50 - Train Loss: 1.2936, Train Acc: 31.11% - Val Loss: 1.1316, Val Acc: 66.67%
2025-04-04 16:00:05,749 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,749 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,749 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,749 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:00:05,749 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:00:05,876 - INFO - Epoch 37/50 - Train Loss: 1.4443, Train Acc: 17.78% - Val Loss: 1.1456, Val Acc: 75.00%
2025-04-04 16:00:05,877 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,877 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,877 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,877 - INFO -   mixed: 100.00% (1/1)
2025-04-04 16:00:05,877 - INFO - EarlyStopping counter: 3/10
2025-04-04 16:00:05,877 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:00:05,990 - INFO - Epoch 38/50 - Train Loss: 1.4231, Train Acc: 15.56% - Val Loss: 1.1658, Val Acc: 75.00%
2025-04-04 16:00:05,990 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:05,990 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:05,990 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:05,990 - INFO -   mixed: 100.00% (1/1)
2025-04-04 16:00:05,990 - INFO - EarlyStopping counter: 9/10
2025-04-04 16:00:05,990 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:00:06,106 - INFO - Epoch 39/50 - Train Loss: 1.3933, Train Acc: 20.00% - Val Loss: 1.1717, Val Acc: 75.00%
2025-04-04 16:00:06,106 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:00:06,106 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:00:06,106 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:00:06,106 - INFO -   mixed: 100.00% (1/1)
2025-04-04 16:00:06,106 - INFO - EarlyStopping counter: 10/10
2025-04-04 16:00:06,106 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:00:06,106 - INFO - Early Stopping in Epoche 39
2025-04-04 16:00:06,106 - INFO - Training abgeschlossen in 4.79 Sekunden
2025-04-04 16:00:06,108 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-04 16:00:06,109 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-04 16:00:06,109 - INFO - Starte detaillierte Modellevaluierung...
2025-04-04 16:00:06,162 - INFO - 
==================================================
2025-04-04 16:00:06,162 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-04 16:00:06,162 - INFO - ==================================================
2025-04-04 16:00:06,162 - INFO - Gesamtgenauigkeit: 66.67%
2025-04-04 16:00:06,162 - INFO - Makro-Präzision: 0.1111
2025-04-04 16:00:06,162 - INFO - Makro-Recall: 0.1667
2025-04-04 16:00:06,162 - INFO - Makro-F1: 0.1333
2025-04-04 16:00:06,162 - INFO - Mikro-F1 (Genauigkeit): 0.6667
2025-04-04 16:00:06,163 - INFO - 
Klassenweise Leistung:
2025-04-04 16:00:06,163 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-04 16:00:06,163 - INFO - ------------------------------------------------------------
2025-04-04 16:00:06,163 - INFO - basic           0.6667      1.0000      0.8000      8
2025-04-04 16:00:06,163 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-04 16:00:06,163 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-04 16:00:06,163 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-04 16:00:06,163 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-04 16:00:06,163 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-04 16:00:06,163 - INFO - 
Top-5 häufigste Fehler:
2025-04-04 16:00:06,163 - INFO - 1. combined als basic klassifiziert: 3 Fälle
2025-04-04 16:00:06,163 - INFO - 2. mixed als basic klassifiziert: 1 Fälle
2025-04-04 16:00:06,163 - INFO - 
Konfusionsmatrix:
2025-04-04 16:00:06,163 - INFO -     8     0     0     0     0     0
    0     0     0     0     0     0
    3     0     0     0     0     0
    1     0     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-04 16:00:06,163 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-04 16:00:06,163 - INFO - Erstelle Visualisierungen...
2025-04-04 16:00:06,883 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-04 16:00:06,883 - INFO - Starting calibration and quantization of the model...
2025-04-04 16:00:06,953 - INFO - Calibrating with 37 representative samples
2025-04-04 16:00:07,289 - WARNING - Quantization failed: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-04 16:00:07,289 - WARNING - Using non-quantized model for export
2025-04-04 16:00:07,290 - INFO - Original float32 model saved to: models_optimized/pizza_model_float32.pth
2025-04-04 16:00:07,290 - INFO - Float32 model size: 9.24 KB
2025-04-04 16:00:07,290 - INFO - Theoretical int8 size would be approximately: 2.31 KB
2025-04-04 16:00:07,290 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-04 16:00:07,291 - INFO - Erstelle synthetische Kalibrierungsdaten...
2025-04-04 16:00:07,292 - INFO - Erstellt: 50 synthetische Kalibrierungssamples für die Quantisierung
2025-04-04 16:00:07,292 - INFO - Konvertiere PyTorch-Modell zu ONNX...
2025-04-04 16:00:07,318 - ERROR - Fehler beim Exportieren des Modells: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument weight in method wrapper_CUDA___slow_conv2d_forward)
2025-04-04 16:00:07,321 - ERROR - Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1776, in export_to_microcontroller
    torch.onnx.export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/__init__.py", line 383, in export
    export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 495, in export
    _export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 1428, in _export
    graph, params_dict, torch_out = _model_to_graph(
                                    ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 1053, in _model_to_graph
    graph, params, torch_out, module = _create_jit_graph(model, args)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 937, in _create_jit_graph
    graph, torch_out = _trace_and_get_graph_from_model(model, args)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 844, in _trace_and_get_graph_from_model
    trace_graph, torch_out, inputs_states = torch.jit._get_trace_graph(
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 1498, in _get_trace_graph
    outs = ONNXTracedModule(
           ^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 138, in forward
    graph, _out = torch._C._create_graph_by_tracing(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 129, in wrapper
    outs.append(self.inner(*trace_inputs))
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 949, in forward
    x = self.block1(x)
        ^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument weight in method wrapper_CUDA___slow_conv2d_forward)

2025-04-04 16:00:07,322 - INFO - 
================================================================================
2025-04-04 16:00:07,322 - INFO - ZUSAMMENFASSUNG DES OPTIMIERUNGSPROZESSES
2025-04-04 16:00:07,322 - INFO - ================================================================================
2025-04-04 16:00:07,322 - INFO - Gesamtzeit: 0.11 Minuten
2025-04-04 16:00:07,322 - INFO - Modellgröße: 9.24 KB (quantisiert)
2025-04-04 16:00:07,322 - INFO - Genauigkeit: 66.67%
2025-04-04 16:00:07,322 - INFO - Makro-F1-Score: 0.1333
2025-04-04 16:00:07,322 - INFO - Export-Verzeichnis: models_optimized/rp2040_export
2025-04-04 16:00:07,322 - INFO - ================================================================================
2025-04-04 16:00:07,322 - INFO - Abschließende README erstellt: models_optimized/README.md
2025-04-04 16:09:37,896 - INFO - ================================================================================
2025-04-04 16:09:37,896 - INFO - RP2040 PIZZA-ERKENNUNGSSYSTEM - DETAILLIERTE KONFIGURATION
2025-04-04 16:09:37,896 - INFO - ================================================================================
2025-04-04 16:09:37,896 - INFO - Hardware: RP2040 - 133MHz, 264KB RAM, 2048KB Flash
2025-04-04 16:09:37,896 - INFO - Kamera: OV2640 - 320x240, 7 FPS
2025-04-04 16:09:37,896 - INFO - Stromversorgung: CR123A - 1500mAh, 8.33h aktiv, 3000.00h standby
2025-04-04 16:09:37,896 - INFO - Modellparameter: 48x48 Eingabegröße, 8-Bit Quantisierung
2025-04-04 16:09:37,896 - INFO - Speicherbeschränkungen: Max. 180KB Modellgröße, 100KB Laufzeit-RAM
2025-04-04 16:09:37,896 - INFO - ================================================================================
2025-04-04 16:09:37,896 - INFO - Analysiere Datensatz in augmented_pizza...
2025-04-04 16:09:37,930 - INFO - Datensatzanalyse abgeschlossen:
2025-04-04 16:09:37,930 - INFO - Gesamtzahl der Bilder: 57
2025-04-04 16:09:37,930 - INFO - Klassenverteilung: {'progression': 0, 'mixed': 7, 'basic': 29, 'segment': 0, 'combined': 17, 'burnt': 4}
2025-04-04 16:09:37,930 - INFO - Durchschnittliche Bildgröße: 224.0 x 224.0
2025-04-04 16:09:37,930 - INFO - RGB-Mittelwerte: [0.4783, 0.3953, 0.3266]
2025-04-04 16:09:37,930 - INFO - RGB-Standardabweichungen: [0.2249, 0.2451, 0.2601]
2025-04-04 16:09:37,930 - INFO - Preparing optimized data loaders...
2025-04-04 16:09:37,930 - INFO - Using dataset-specific normalization: mean=[0.4783162  0.39527235 0.32664445], std=[0.22493517 0.24509087 0.26005925]
2025-04-04 16:09:37,931 - INFO - Data loaders created: 45 training images, 12 validation images
2025-04-04 16:09:37,931 - INFO - Classes: ['basic', 'burnt', 'combined', 'mixed', 'progression', 'segment']
2025-04-04 16:09:38,045 - INFO - Modell erstellt mit 582 Parametern
2025-04-04 16:09:38,169 - INFO - Speicheranalyse:
2025-04-04 16:09:38,169 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 16:09:38,169 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 16:09:38,169 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 16:09:38,169 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 16:09:38,169 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 16:09:38,169 - INFO - Starte optimiertes Training für Mikrocontroller-Modell...
2025-04-04 16:09:38,170 - INFO - Speicheranalyse:
2025-04-04 16:09:38,170 - INFO -   Modellgröße (Float32): 2.54 KB
2025-04-04 16:09:38,170 - INFO -   Modellgröße (Int8): 0.63 KB (0.0% des Flash)
2025-04-04 16:09:38,170 - INFO -   Aktivierungsspeicher: 101.46 KB
2025-04-04 16:09:38,170 - INFO -   Gesamter Laufzeitspeicher: 102.09 KB (38.7% des RAM)
2025-04-04 16:09:38,170 - WARNING - Warnung: Laufzeitspeicher überschreitet RAM-Beschränkung (102.09KB > 100KB)
2025-04-04 16:09:38,230 - INFO - Klassengewichte für Loss-Funktion: [0.83, 1.07, 0.47, 0.58, 1.0, 1.0]
2025-04-04 16:09:38,490 - INFO - Epoch 1/50 - Train Loss: 1.7891, Train Acc: 17.78% - Val Loss: 1.7884, Val Acc: 66.67%
2025-04-04 16:09:38,491 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:38,491 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:09:38,491 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:38,491 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:38,492 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch1.pth
2025-04-04 16:09:38,633 - INFO - Epoch 2/50 - Train Loss: 1.7831, Train Acc: 22.22% - Val Loss: 1.7857, Val Acc: 66.67%
2025-04-04 16:09:38,633 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:38,633 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:09:38,633 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:38,633 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:38,763 - INFO - Epoch 3/50 - Train Loss: 1.7832, Train Acc: 15.56% - Val Loss: 1.7821, Val Acc: 66.67%
2025-04-04 16:09:38,763 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:38,763 - INFO -   basic: 100.00% (8/8)
2025-04-04 16:09:38,763 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:38,763 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:38,896 - INFO - Epoch 4/50 - Train Loss: 1.7704, Train Acc: 31.11% - Val Loss: 1.7770, Val Acc: 58.33%
2025-04-04 16:09:38,896 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:38,896 - INFO -   basic: 87.50% (7/8)
2025-04-04 16:09:38,896 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:38,896 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,028 - INFO - Epoch 5/50 - Train Loss: 1.7732, Train Acc: 26.67% - Val Loss: 1.7712, Val Acc: 25.00%
2025-04-04 16:09:39,028 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,028 - INFO -   basic: 37.50% (3/8)
2025-04-04 16:09:39,028 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,028 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,029 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch5.pth
2025-04-04 16:09:39,152 - INFO - Epoch 6/50 - Train Loss: 1.7569, Train Acc: 31.11% - Val Loss: 1.7640, Val Acc: 0.00%
2025-04-04 16:09:39,152 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,152 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,153 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,153 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,287 - INFO - Epoch 7/50 - Train Loss: 1.7420, Train Acc: 28.89% - Val Loss: 1.7549, Val Acc: 0.00%
2025-04-04 16:09:39,288 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,288 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,288 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,288 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,417 - INFO - Epoch 8/50 - Train Loss: 1.7282, Train Acc: 26.67% - Val Loss: 1.7407, Val Acc: 0.00%
2025-04-04 16:09:39,417 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,417 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,417 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,417 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,548 - INFO - Epoch 9/50 - Train Loss: 1.7055, Train Acc: 31.11% - Val Loss: 1.7258, Val Acc: 0.00%
2025-04-04 16:09:39,548 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,548 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,548 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,548 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,697 - INFO - Epoch 10/50 - Train Loss: 1.6714, Train Acc: 28.89% - Val Loss: 1.7081, Val Acc: 0.00%
2025-04-04 16:09:39,697 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,697 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,697 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,697 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:39,699 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch10.pth
2025-04-04 16:09:39,853 - INFO - Epoch 11/50 - Train Loss: 1.6582, Train Acc: 26.67% - Val Loss: 1.6958, Val Acc: 0.00%
2025-04-04 16:09:39,853 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:39,853 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:39,853 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:39,853 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,001 - INFO - Epoch 12/50 - Train Loss: 1.5881, Train Acc: 44.44% - Val Loss: 1.6931, Val Acc: 0.00%
2025-04-04 16:09:40,001 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,001 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,002 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,002 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,131 - INFO - Epoch 13/50 - Train Loss: 1.6111, Train Acc: 20.00% - Val Loss: 1.6829, Val Acc: 0.00%
2025-04-04 16:09:40,132 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,132 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,132 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,132 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,269 - INFO - Epoch 14/50 - Train Loss: 1.5144, Train Acc: 37.78% - Val Loss: 1.6713, Val Acc: 0.00%
2025-04-04 16:09:40,270 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,270 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,270 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,270 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,398 - INFO - Epoch 15/50 - Train Loss: 1.4810, Train Acc: 37.78% - Val Loss: 1.6790, Val Acc: 0.00%
2025-04-04 16:09:40,398 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,398 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,398 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,398 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,398 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:40,400 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch15.pth
2025-04-04 16:09:40,539 - INFO - Epoch 16/50 - Train Loss: 1.4283, Train Acc: 42.22% - Val Loss: 1.7009, Val Acc: 0.00%
2025-04-04 16:09:40,539 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,539 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,539 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,539 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,539 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:09:40,667 - INFO - Epoch 17/50 - Train Loss: 1.5186, Train Acc: 24.44% - Val Loss: 1.7001, Val Acc: 0.00%
2025-04-04 16:09:40,667 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,667 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,667 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,667 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,667 - INFO - EarlyStopping counter: 3/10
2025-04-04 16:09:40,667 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:09:40,793 - INFO - Epoch 18/50 - Train Loss: 1.4614, Train Acc: 28.89% - Val Loss: 1.6872, Val Acc: 0.00%
2025-04-04 16:09:40,794 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,794 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,794 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,794 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:40,794 - INFO - EarlyStopping counter: 9/10
2025-04-04 16:09:40,794 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:09:40,921 - INFO - Epoch 19/50 - Train Loss: 1.4834, Train Acc: 26.67% - Val Loss: 1.6644, Val Acc: 0.00%
2025-04-04 16:09:40,922 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:40,922 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:40,922 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:40,922 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,047 - INFO - Epoch 20/50 - Train Loss: 1.4266, Train Acc: 26.67% - Val Loss: 1.6667, Val Acc: 0.00%
2025-04-04 16:09:41,047 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,047 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,047 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,047 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,047 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:41,048 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch20.pth
2025-04-04 16:09:41,180 - INFO - Epoch 21/50 - Train Loss: 1.4155, Train Acc: 24.44% - Val Loss: 1.6630, Val Acc: 0.00%
2025-04-04 16:09:41,180 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,180 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,180 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,180 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,310 - INFO - Epoch 22/50 - Train Loss: 1.5045, Train Acc: 15.56% - Val Loss: 1.6359, Val Acc: 0.00%
2025-04-04 16:09:41,310 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,310 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,310 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,310 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,449 - INFO - Epoch 23/50 - Train Loss: 1.3756, Train Acc: 28.89% - Val Loss: 1.6136, Val Acc: 0.00%
2025-04-04 16:09:41,449 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,449 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,449 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,449 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,576 - INFO - Epoch 24/50 - Train Loss: 1.4420, Train Acc: 22.22% - Val Loss: 1.6112, Val Acc: 0.00%
2025-04-04 16:09:41,576 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,576 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,576 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,576 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,700 - INFO - Epoch 25/50 - Train Loss: 1.3567, Train Acc: 31.11% - Val Loss: 1.6192, Val Acc: 0.00%
2025-04-04 16:09:41,700 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,700 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,700 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,700 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,700 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:41,702 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch25.pth
2025-04-04 16:09:41,835 - INFO - Epoch 26/50 - Train Loss: 1.3212, Train Acc: 33.33% - Val Loss: 1.6036, Val Acc: 0.00%
2025-04-04 16:09:41,835 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,835 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,835 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,835 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:41,965 - INFO - Epoch 27/50 - Train Loss: 1.2823, Train Acc: 35.56% - Val Loss: 1.5833, Val Acc: 0.00%
2025-04-04 16:09:41,965 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:41,965 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:41,965 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:41,965 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,100 - INFO - Epoch 28/50 - Train Loss: 1.2939, Train Acc: 35.56% - Val Loss: 1.5751, Val Acc: 0.00%
2025-04-04 16:09:42,100 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,100 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,100 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,100 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,231 - INFO - Epoch 29/50 - Train Loss: 1.2943, Train Acc: 33.33% - Val Loss: 1.5669, Val Acc: 0.00%
2025-04-04 16:09:42,231 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,231 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,232 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,232 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,360 - INFO - Epoch 30/50 - Train Loss: 1.2877, Train Acc: 33.33% - Val Loss: 1.5668, Val Acc: 0.00%
2025-04-04 16:09:42,360 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,360 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,360 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,360 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,360 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:42,361 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch30.pth
2025-04-04 16:09:42,493 - INFO - Epoch 31/50 - Train Loss: 1.3563, Train Acc: 24.44% - Val Loss: 1.5663, Val Acc: 0.00%
2025-04-04 16:09:42,493 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,493 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,493 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,493 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,493 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:09:42,626 - INFO - Epoch 32/50 - Train Loss: 1.2873, Train Acc: 31.11% - Val Loss: 1.5616, Val Acc: 0.00%
2025-04-04 16:09:42,626 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,626 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,626 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,626 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,752 - INFO - Epoch 33/50 - Train Loss: 1.4694, Train Acc: 13.33% - Val Loss: 1.5679, Val Acc: 0.00%
2025-04-04 16:09:42,752 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,752 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,753 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,753 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,753 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:42,877 - INFO - Epoch 34/50 - Train Loss: 1.3730, Train Acc: 26.67% - Val Loss: 1.5618, Val Acc: 0.00%
2025-04-04 16:09:42,877 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:42,878 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:42,878 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:42,878 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:42,878 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:09:43,006 - INFO - Epoch 35/50 - Train Loss: 1.3321, Train Acc: 28.89% - Val Loss: 1.5478, Val Acc: 0.00%
2025-04-04 16:09:43,006 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,006 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,006 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,006 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,007 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch35.pth
2025-04-04 16:09:43,136 - INFO - Epoch 36/50 - Train Loss: 1.3476, Train Acc: 28.89% - Val Loss: 1.5508, Val Acc: 0.00%
2025-04-04 16:09:43,136 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,136 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,136 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,136 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,136 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:43,264 - INFO - Epoch 37/50 - Train Loss: 1.2541, Train Acc: 40.00% - Val Loss: 1.5417, Val Acc: 0.00%
2025-04-04 16:09:43,264 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,264 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,264 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,264 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,392 - INFO - Epoch 38/50 - Train Loss: 1.3123, Train Acc: 33.33% - Val Loss: 1.5391, Val Acc: 0.00%
2025-04-04 16:09:43,392 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,392 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,392 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,392 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,525 - INFO - Epoch 39/50 - Train Loss: 1.2805, Train Acc: 35.56% - Val Loss: 1.5550, Val Acc: 0.00%
2025-04-04 16:09:43,525 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,525 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,525 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,525 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,525 - INFO - EarlyStopping counter: 1/10
2025-04-04 16:09:43,661 - INFO - Epoch 40/50 - Train Loss: 1.2095, Train Acc: 40.00% - Val Loss: 1.5630, Val Acc: 0.00%
2025-04-04 16:09:43,661 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,662 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,662 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,662 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,662 - INFO - EarlyStopping counter: 2/10
2025-04-04 16:09:43,663 - INFO - Checkpoint gespeichert: models_optimized/micro_pizza_model_epoch40.pth
2025-04-04 16:09:43,792 - INFO - Epoch 41/50 - Train Loss: 1.4671, Train Acc: 15.56% - Val Loss: 1.5816, Val Acc: 0.00%
2025-04-04 16:09:43,792 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,792 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,792 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,792 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,792 - INFO - EarlyStopping counter: 3/10
2025-04-04 16:09:43,792 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:09:43,917 - INFO - Epoch 42/50 - Train Loss: 1.2857, Train Acc: 31.11% - Val Loss: 1.5815, Val Acc: 0.00%
2025-04-04 16:09:43,917 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:43,917 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:43,917 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:43,917 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:43,917 - INFO - EarlyStopping counter: 9/10
2025-04-04 16:09:43,917 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:09:44,042 - INFO - Epoch 43/50 - Train Loss: 1.2421, Train Acc: 37.78% - Val Loss: 1.5854, Val Acc: 0.00%
2025-04-04 16:09:44,042 - INFO - Klassenweise Genauigkeiten:
2025-04-04 16:09:44,042 - INFO -   basic: 0.00% (0/8)
2025-04-04 16:09:44,042 - INFO -   combined: 0.00% (0/3)
2025-04-04 16:09:44,042 - INFO -   mixed: 0.00% (0/1)
2025-04-04 16:09:44,042 - INFO - EarlyStopping counter: 10/10
2025-04-04 16:09:44,042 - INFO - Plateau oder steigender Validierungsverlust erkannt
2025-04-04 16:09:44,042 - INFO - Early Stopping in Epoche 43
2025-04-04 16:09:44,042 - INFO - Training abgeschlossen in 5.81 Sekunden
2025-04-04 16:09:44,043 - INFO - Beste Modellgewichte wiederhergestellt
2025-04-04 16:09:44,044 - INFO - Modell gespeichert als: models_optimized/micro_pizza_model.pth
2025-04-04 16:09:44,044 - INFO - Starte detaillierte Modellevaluierung...
2025-04-04 16:09:44,101 - INFO - 
==================================================
2025-04-04 16:09:44,101 - INFO - DETAILLIERTE EVALUIERUNG
2025-04-04 16:09:44,101 - INFO - ==================================================
2025-04-04 16:09:44,101 - INFO - Gesamtgenauigkeit: 0.00%
2025-04-04 16:09:44,101 - INFO - Makro-Präzision: 0.0000
2025-04-04 16:09:44,101 - INFO - Makro-Recall: 0.0000
2025-04-04 16:09:44,101 - INFO - Makro-F1: 0.0000
2025-04-04 16:09:44,101 - INFO - Mikro-F1 (Genauigkeit): 0.0000
2025-04-04 16:09:44,101 - INFO - 
Klassenweise Leistung:
2025-04-04 16:09:44,101 - INFO - Klasse          Precision  Recall     F1         Support
2025-04-04 16:09:44,101 - INFO - ------------------------------------------------------------
2025-04-04 16:09:44,101 - INFO - basic           0.0000      0.0000      0.0000      8
2025-04-04 16:09:44,101 - INFO - burnt           0.0000      0.0000      0.0000      0
2025-04-04 16:09:44,101 - INFO - combined        0.0000      0.0000      0.0000      3
2025-04-04 16:09:44,101 - INFO - mixed           0.0000      0.0000      0.0000      1
2025-04-04 16:09:44,101 - INFO - progression     0.0000      0.0000      0.0000      0
2025-04-04 16:09:44,101 - INFO - segment         0.0000      0.0000      0.0000      0
2025-04-04 16:09:44,101 - INFO - 
Top-5 häufigste Fehler:
2025-04-04 16:09:44,101 - INFO - 1. basic als burnt klassifiziert: 8 Fälle
2025-04-04 16:09:44,101 - INFO - 2. combined als burnt klassifiziert: 3 Fälle
2025-04-04 16:09:44,101 - INFO - 3. mixed als burnt klassifiziert: 1 Fälle
2025-04-04 16:09:44,101 - INFO - 
Konfusionsmatrix:
2025-04-04 16:09:44,101 - INFO -     0     8     0     0     0     0
    0     0     0     0     0     0
    0     3     0     0     0     0
    0     1     0     0     0     0
    0     0     0     0     0     0
    0     0     0     0     0     0
2025-04-04 16:09:44,102 - INFO - 
Vollständiger Evaluierungsbericht gespeichert: models_optimized/evaluation_report.json
2025-04-04 16:09:44,102 - INFO - Erstelle Visualisierungen...
2025-04-04 16:09:44,853 - INFO - Visualisierungen gespeichert in: models_optimized/visualizations
2025-04-04 16:09:44,854 - INFO - Starting calibration and quantization of the model...
2025-04-04 16:09:44,924 - INFO - Calibrating with 39 representative samples
2025-04-04 16:09:45,330 - WARNING - Quantization failed: Quantized cudnn conv2d is currently limited to groups = 1; received groups =8
2025-04-04 16:09:45,330 - WARNING - Using non-quantized model for export
2025-04-04 16:09:45,331 - INFO - Original float32 model saved to: models_optimized/pizza_model_float32.pth
2025-04-04 16:09:45,331 - INFO - Float32 model size: 9.24 KB
2025-04-04 16:09:45,331 - INFO - Theoretical int8 size would be approximately: 2.31 KB
2025-04-04 16:09:45,331 - INFO - Exportiere Modell für RP2040-Mikrocontroller...
2025-04-04 16:09:45,331 - INFO - Erstelle synthetische Kalibrierungsdaten...
2025-04-04 16:09:45,333 - INFO - Erstellt: 50 synthetische Kalibrierungssamples für die Quantisierung
2025-04-04 16:09:45,333 - INFO - Konvertiere PyTorch-Modell zu ONNX...
2025-04-04 16:09:45,334 - ERROR - Fehler beim Exportieren des Modells: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument weight in method wrapper_CUDA___slow_conv2d_forward)
2025-04-04 16:09:45,336 - ERROR - Traceback (most recent call last):
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 1776, in export_to_microcontroller
    torch.onnx.export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/__init__.py", line 383, in export
    export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 495, in export
    _export(
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 1428, in _export
    graph, params_dict, torch_out = _model_to_graph(
                                    ^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 1053, in _model_to_graph
    graph, params, torch_out, module = _create_jit_graph(model, args)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 937, in _create_jit_graph
    graph, torch_out = _trace_and_get_graph_from_model(model, args)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/onnx/utils.py", line 844, in _trace_and_get_graph_from_model
    trace_graph, torch_out, inputs_states = torch.jit._get_trace_graph(
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 1498, in _get_trace_graph
    outs = ONNXTracedModule(
           ^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 138, in forward
    graph, _out = torch._C._create_graph_by_tracing(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/jit/_trace.py", line 129, in wrapper
    outs.append(self.inner(*trace_inputs))
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/pizza-baking-detection-final.py", line 949, in forward
    x = self.block1(x)
        ^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in _slow_forward
    result = self.forward(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/emilio/Documents/ai/pizza/.venv/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument weight in method wrapper_CUDA___slow_conv2d_forward)

2025-04-04 16:09:45,336 - INFO - 
================================================================================
2025-04-04 16:09:45,336 - INFO - ZUSAMMENFASSUNG DES OPTIMIERUNGSPROZESSES
2025-04-04 16:09:45,336 - INFO - ================================================================================
2025-04-04 16:09:45,336 - INFO - Gesamtzeit: 0.12 Minuten
2025-04-04 16:09:45,336 - INFO - Modellgröße: 9.24 KB (quantisiert)
2025-04-04 16:09:45,336 - INFO - Genauigkeit: 0.00%
2025-04-04 16:09:45,336 - INFO - Makro-F1-Score: 0.0000
2025-04-04 16:09:45,336 - INFO - Export-Verzeichnis: models_optimized/rp2040_export
2025-04-04 16:09:45,336 - INFO - ================================================================================
2025-04-04 16:09:45,337 - INFO - Abschließende README erstellt: models_optimized/README.md
